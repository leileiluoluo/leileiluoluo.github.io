<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>Java 中如何使用 MapStruct 进行对象映射？ - 磊磊落落</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="Java,MapStruct,对象映射"><meta name=description content="MapStruct 是一款基于注解的、用于 Java 对象映射的代码生成器。借助 MapStruct，我们做对象转换时，只需按照约定指定映射关系，真正的逐字段映射交给 MapStruct 去做即可，可以省去大量手工代码的编写。而且，MapStruct 是在编译期生成映射代码，若有字段类型不一致的映射，会提前报错，其生成的代码更加安全可靠。再者，MapStruct 生成的代码的执行性能与我们手工编写的代码无异，远优于市面上流行的几款基于反射的映射框架（如 BeanUtils、ModelMapper 等）。本文即以普通的基于 Maven 管理的 Java 项目为基础，以实际项目中的 VO（值对象）到 DTO（数据传输对象）的转换为例来演示 MapStruct 的常用功能和使用方式。"><meta name=author content="磊磊落落"><meta name=generator content="Hugo 0.123.7"><link rel=stylesheet href=https://leileiluoluo.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/themify-icons.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/larry-custom-v1.6.css><link rel=stylesheet href=https://leileiluoluo.github.io/scss/style.min.css media=screen><link rel="shortcut icon" href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><link rel=icon href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?526723b767317055572c85bdb445353c",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><header class="fixed-top navigation"><div class=container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><a class=navbar-brand href=https://leileiluoluo.github.io/>磊磊落落</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/></a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/>计算机</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E9%9A%8F%E7%AC%94/>随笔</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AF%BB%E4%B9%A6/>读书</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%A7%82%E5%BD%B1/>观影</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E7%BB%83%E5%AD%97/>练字</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/about>关于</a></li></ul><div class=search><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://leileiluoluo.github.io//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder=键入关键字后回车...></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><div class="py-5 d-none d-lg-block"></div><section class=section><div class=container><div class=row><div class="col-lg-8 mx-auto block shadow mb-5"><h1>Java 中如何使用 MapStruct 进行对象映射？</h1><div class="mb-3 post-meta">2025年08月28日
<a href=/categories/%e8%ae%a1%e7%ae%97%e6%9c%ba>计算机</a></div><div class="content mb-5"><p>MapStruct 是一款基于注解的、用于 Java 对象映射的代码生成器。借助 MapStruct，我们做对象转换时，只需按照约定指定映射关系，真正的逐字段映射交给 MapStruct 去做即可，可以省去大量手工代码的编写。而且，MapStruct 是在编译期生成映射代码，若有字段类型不一致的映射，会提前报错，其生成的代码更加安全可靠。再者，MapStruct 生成的代码的执行性能与我们手工编写的代码无异，远优于市面上流行的几款基于反射的映射框架（如 BeanUtils、ModelMapper 等）。</p><p>本文即以常见的基于 Maven 管理的 Java 项目为基础，以实际项目中的 VO（值对象）到 DTO（数据传输对象）的转换为例来演示 MapStruct 的常用功能和使用方式。</p><p>写作本文时，用到的 Java、MapStruct、Lombok 的版本如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Java: 17
</span></span><span style=display:flex><span>MapStruct: 1.6.3
</span></span><span style=display:flex><span>Lombok: 1.18.38
</span></span></code></pre></div><h2 id=1-引入-maven-依赖>1 引入 Maven 依赖</h2><p>开始前，需要在 <code>pom.xml</code> 引入相应的依赖。本示例工程为了省去编写 POJO 类冗长的 Setters 和 Getters，使用了 Lombok。</p><p>我们知道，Lombok 是在编译期生成代码的，而 MapStruct 也是在编译期生成代码的。所以两者应该有个先后顺序，Lombok 的代码生成要在 MapStruct 的代码生成之前执行，否则 MapStruct 会在设置字段时因找不到对应的 Setters 或 Getters 而报错。因此，除了引入 Lombok 和 MapStruct 依赖外，我们还在 <code>maven-compiler-plugin</code> 的 <code>annotationProcessorPaths</code> 部分指定了两者的处理顺序。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:navy>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;java.version&gt;</span>17<span style=color:navy>&lt;/java.version&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;lombok.version&gt;</span>1.18.38<span style=color:navy>&lt;/lombok.version&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;mapstruct.version&gt;</span>1.6.3<span style=color:navy>&lt;/mapstruct.version&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;/properties&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;dependencies&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>org.projectlombok<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>lombok<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;version&gt;</span>${lombok.version}<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;scope&gt;</span>provided<span style=color:navy>&lt;/scope&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>org.mapstruct<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>mapstruct<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;version&gt;</span>${mapstruct.version}<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;/dependencies&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;build&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;plugins&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;artifactId&gt;</span>maven-compiler-plugin<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;version&gt;</span>3.14.0<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:navy>&lt;source&gt;</span>${java.version}<span style=color:navy>&lt;/source&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:navy>&lt;target&gt;</span>${java.version}<span style=color:navy>&lt;/target&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:navy>&lt;annotationProcessorPaths&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:navy>&lt;path&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;groupId&gt;</span>org.projectlombok<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;artifactId&gt;</span>lombok<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;version&gt;</span>${lombok.version}<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:navy>&lt;/path&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:navy>&lt;path&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;groupId&gt;</span>org.projectlombok<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;artifactId&gt;</span>lombok-mapstruct-binding<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;version&gt;</span>0.2.0<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:navy>&lt;/path&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:navy>&lt;path&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;groupId&gt;</span>org.mapstruct<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;artifactId&gt;</span>mapstruct-processor<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:navy>&lt;version&gt;</span>${mapstruct.version}<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:navy>&lt;/path&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:navy>&lt;/annotationProcessorPaths&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/plugins&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;/build&gt;</span>
</span></span></code></pre></div><h2 id=2-基础用法>2 基础用法</h2><p>依赖引入好后，下面就可以开始对 MapStruct 进行使用了。本小节先看一下 MapStruct 的基础用法，下个小节再探索其高级功能。</p><p>我们实现的场景是 VO 到 DTO 的转换。</p><p>下面就是 <code>User</code> VO 的源码，其拥有 <code>id</code>、<code>email</code>、<code>name</code>、<code>yearOfBirth</code>、<code>role</code> 和 <code>createdAt</code> 六个属性。除了 <code>role</code> 为枚举类型外，其它均为基础类型。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.vo</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Data</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>User</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Long<span style=color:#bbb> </span>id;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>email;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>name;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Integer<span style=color:#bbb> </span>yearOfBirth;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Role<span style=color:#bbb> </span>role;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Date<span style=color:#bbb> </span>createdAt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.vo</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>enum</span><span style=color:#bbb> </span>Role<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>NORMAL,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>ADMIN<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>下面是 <code>User</code> VO 的目标对象 <code>UserDto</code> 的源码。<code>UserDto</code> 除了和 <code>User</code> 拥有完全相同的字段 <code>id</code> 和 <code>email</code> 外，其它字段要么是名字相同但类型不同（如 <code>role</code>、<code>createdDate</code>）、要么是类型相同但名字不同（如 <code>username</code>）、要么是全新的字段（如 <code>age</code>、<code>newCenturyUser</code>）。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.dto</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Data</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>UserDto</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Long<span style=color:#bbb> </span>id;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>email;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>username;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Integer<span style=color:#bbb> </span>age;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Boolean<span style=color:#bbb> </span>newCenturyUser;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>role;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>LocalDateTime<span style=color:#bbb> </span>createdDate;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>下面即使用 MapStruct 来为 <code>User</code> 到 <code>UserDto</code> 的转换做映射。</p><p>可以看到，我们需要定义一个专门做转换的接口 <code>UserMapper</code>，并在其上配置 <code>@Mapper</code> 注解，然后在接口中定义一个 <code>User</code> 到 <code>UserDto</code> 的转换方法 <code>toUserDto()</code>。</p><p>接下来就是字段级的映射配置了：</p><ul><li><p><code>id</code> 和 <code>email</code> 字段在两个 POJO 中完全相同，无需配置，MapStruct 会自动帮我们做映射。</p></li><li><p><code>name</code> 到 <code>username</code> 的映射，因名称发生了变化，需要使用 <code>@Mapping</code> 注解来指定源字段和目的字段的对应关系。</p></li><li><p><code>yearOfBirth</code> 到 <code>age</code> 的映射，因字段意义发生变化，需要进行计算。可通过在 <code>UserMapper</code> 接口定义一个默认方法 <code>calculateAge</code>，然后在 <code>@Mapping</code> 映射中使用 <code>qualifiedByName</code> 指定该实现方法来达成。</p></li><li><p><code>role</code> 字段在源对象中是枚举类型，而在目的对象中是 <code>String</code> 类型，我们无需做处理，MapStruct 会自动帮我们将枚举的 <code>name()</code> 值设置到目标字段。</p></li><li><p><code>newCenturyUser</code> 是目标对象的一个新字段，其需基于源对象的 <code>yearOfBirth</code> 字段进行计算，可以通过指定一个表达式（expression）来达成。</p></li><li><p>源字段的 <code>createdAt</code> 是 <code>Date</code> 类型，目的字段的 <code>createdDate</code> 是 <code>LocalDateTime</code> 类型，可以通过引入一个两者转换的 Util 类或其它 Mapper 来达成（这里引入了 <code>DateTimeUtil</code> 工具类，且在 <code>@Mapping</code> 映射中未指定任何方法，因为 MapStruct 会自动帮我们检测适用的方法并调用）。</p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Mapper</span>(uses<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>DateTimeUtil.<span style=color:teal>class</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>UserMapper</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>UserMapper<span style=color:#bbb> </span>INSTANCE<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Mappers.<span style=color:teal>getMapper</span>(UserMapper.<span style=color:teal>class</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;name&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;username&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;yearOfBirth&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;age&#34;</span>,<span style=color:#bbb> </span>qualifiedByName<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;calculateAge&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;newCenturyUser&#34;</span>,<span style=color:#bbb> </span>expression<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;java(user.getYearOfBirth() &gt;= 2000)&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;createdAt&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;createdDate&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>UserDto<span style=color:#bbb> </span><span style=color:#900;font-weight:700>toUserDto</span>(User<span style=color:#bbb> </span>user);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Named</span>(<span style=color:#d14>&#34;calculateAge&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>default</span><span style=color:#bbb> </span>Integer<span style=color:#bbb> </span><span style=color:#900;font-weight:700>calculateAge</span>(Integer<span style=color:#bbb> </span>yearOfBirth)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Calendar<span style=color:#bbb> </span>calendar<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Calendar.<span style=color:teal>getInstance</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>calendar.<span style=color:teal>get</span>(Calendar.<span style=color:teal>YEAR</span>)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-</span><span style=color:#bbb> </span>yearOfBirth;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>下面即是 <code>DateTimeUtil</code> 工具类的源码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.util</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>DateTimeUtil</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span>LocalDateTime<span style=color:#bbb> </span><span style=color:#900;font-weight:700>asLocalDateTime</span>(Date<span style=color:#bbb> </span>date)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>if</span><span style=color:#bbb> </span>(<span style=color:#000;font-weight:700>null</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>==</span><span style=color:#bbb> </span>date)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>null</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>date.<span style=color:teal>toInstant</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>atZone</span>(ZoneId.<span style=color:teal>systemDefault</span>())<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>toLocalDateTime</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，MapStruct 的使用还是比较简单的：名称与类型完全相同的字段无需任何额外配置；类型相同但名称不同的字段则只需指定 source 和 target 即可；需要额外计算的字段，可以通过编写表达式或引入其它 Mapper 或工具类来实现。</p><p>使用 <code>mvn clean package</code> 命令将工程编译后会发现 MapStruct 在 <code>target/classes</code> 目录对应位置根据我们的要求自动生成了 <code>UserMapper</code> 的实现类 <code>UserMapperImpl</code>。</p><p><img loading=lazy src=https://leileiluoluo.github.io/static/images/uploads/2025/08/mapstruct-generated-impl.png alt="MapStruct 自动生成的实现类"></p><p>最后，我们编写一个单元测试类来对上述 Mapper 进行一下测试。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>UserMapperTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Test</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>testToUserDto</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>User<span style=color:#bbb> </span>user<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>User();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setId</span>(1L);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setEmail</span>(<span style=color:#d14>&#34;larry@larry.com&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setName</span>(<span style=color:#d14>&#34;Larry&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setYearOfBirth</span>(2000);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setRole</span>(Role.<span style=color:teal>NORMAL</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setCreatedAt</span>(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Date());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>UserDto<span style=color:#bbb> </span>userDto<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>UserMapper.<span style=color:teal>INSTANCE</span>.<span style=color:teal>toUserDto</span>(user);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(userDto);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>执行 <code>mvn clean test</code> 命令运行如上单元测试后发现打印的目标对象 <code>UserDto</code> 的字段值与预期一致。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>UserDto(id=1, email=larry@larry.com, username=Larry, age=25, newCenturyUser=true, role=NORMAL, createdDate=2025-08-28T08:30:10.568)
</span></span></code></pre></div><h2 id=3-进阶用法>3 进阶用法</h2><h3 id=31-多个源对象到一个目的对象的映射>3.1 多个源对象到一个目的对象的映射</h3><p>若想将多个源对象映射到一个目的对象，<code>@Mapping</code> 配置也很直观。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Mapper</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>CustomerMapper</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;customer.name&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;name&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;customer.yearOfBirth&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;yearOfBirth&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;address.province&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;province&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;address.city&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;city&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;address.street&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;street&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>CustomerDto<span style=color:#bbb> </span><span style=color:#900;font-weight:700>toCustomerDto</span>(Customer<span style=color:#bbb> </span>customer,<span style=color:#bbb> </span>Address<span style=color:#bbb> </span>address);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=32-嵌套对象和集合对象映射>3.2 嵌套对象和集合对象映射</h3><p>如果对象之间有嵌套，或者是集合对象，MapStruct 也能很好的胜任对应的转换。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.vo</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Data</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>School</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>name;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>List<span style=color:#000;font-weight:700>&lt;</span>Student<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>students;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.dto</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Data</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>SchoolDto</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>name;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>List<span style=color:#000;font-weight:700>&lt;</span>StudentDto<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>students;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Mapper</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>SchoolMapper</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>SchoolDto<span style=color:#bbb> </span><span style=color:#900;font-weight:700>toSchoolDto</span>(School<span style=color:#bbb> </span>school);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>List<span style=color:#000;font-weight:700>&lt;</span>SchoolDto<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>toSchoolDtos</span>(List<span style=color:#000;font-weight:700>&lt;</span>School<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>schools);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=33-逆向映射>3.3 逆向映射</h3><p>若已定义过 <code>User</code> 到 <code>UserDto</code> 的映射，现在想做 <code>UserDto</code> 到 <code>User</code> 的转换怎么办？使用 <code>@InheritInverseConfiguration</code> 注解可以自动生成反向映射规则，避免重复定义。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Mapper</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>UserMapper</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#998;font-style:italic>// @Mapping(xxx)</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>UserDto<span style=color:#bbb> </span><span style=color:#900;font-weight:700>toUserDto</span>(User<span style=color:#bbb> </span>user);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@InheritInverseConfiguration</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>User<span style=color:#bbb> </span><span style=color:#900;font-weight:700>toUser</span>(UserDto<span style=color:#bbb> </span>userDto);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=34-默认值和常量>3.4 默认值和常量</h3><p>还可以为映射提供默认值或常量。下面的示例中：当 <code>User</code> 的 <code>name</code> 字段为 <code>null</code> 时，MapStruct 即会为目标字段赋上默认值 <code>Unknown</code>；此外，还可以为目标对象中 <code>String</code> 类型的 <code>level</code> 字段赋上常量值 <code>PRIMARY</code>。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Mapper</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>UserMapper</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(source<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;name&#34;</span>,<span style=color:#bbb> </span>target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;username&#34;</span>,<span style=color:#bbb> </span>defaultValue<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;Unknown&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Mapping</span>(target<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;level&#34;</span>,<span style=color:#bbb> </span>constant<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;PRIMARY&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>UserDto<span style=color:#bbb> </span><span style=color:#900;font-weight:700>toUserDto</span>(User<span style=color:#bbb> </span>user);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h2 id=4-如何与-spring-框架集成>4 如何与 Spring 框架集成？</h2><p>欲将 MapStruct 与 Spring 集成的话，只需在 Mapper 的 <code>@Mapper</code> 注解上加上 <code>componentModel = "spring"</code> 即可。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Mapper</span>(componentModel<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;spring&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>UserMapper</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>这样，即可取代上面的 <code>UserMapper.INSTANCE</code> 的方式，而直接使用 <code>@Autowired</code> 注解将 <code>UserMapper</code> 进行注入并使用了。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.mapper</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>UserMapperTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Autowired</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>UserMapper<span style=color:#bbb> </span>userMapper;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Test</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>testToUserDto</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// ...</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>UserDto<span style=color:#bbb> </span>userDto<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>userMapper.<span style=color:teal>toUserDto</span>(user);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h2 id=5-小结>5 小结</h2><p>综上，本文首先对 MapStruct 工具进行了介绍，然后创建了一个 Maven 示例工程，并将 MapStruct 和 Lombok 依赖引入；然后以实际项目中的 VO 到 DTO 转换为例，介绍了 MapStruct 的基础功能和高级功能；最后还介绍了 MapStruct 与 Spring 框架的集成。总体上感觉 MapStruct 还是比较易用且高效的。</p><p>本文涉及的所有示例代码均已提交至 <a href=https://github.com/leileiluoluo/java-exercises/blob/main/mapstruct-usage-demo>GitHub</a> 示例工程，供有需要的同学参考。</p><blockquote><p>参考资料</p><p>[1] GitHub: MapStruct - Java bean mappings - <a href=https://github.com/mapstruct/mapstruct>https://github.com/mapstruct/mapstruct</a></p><p>[2] MapStruct: MapStruct 1.6.3 Reference Guide - <a href=https://mapstruct.org/documentation/1.6/reference/html/>https://mapstruct.org/documentation/1.6/reference/html/</a></p><p>[3] GitHub: MapStruct Examples - <a href=https://github.com/mapstruct/mapstruct-examples>https://github.com/mapstruct/mapstruct-examples</a></p></blockquote></div><div class=content-footer><div class=weixinhao><img src=/static/images/self/weixinhao-white.jpg></div><div class=post-tags><a href=/tags/java/>#Java</a></div><div class=license><i class=ti-info-alt></i><div class=info>版权声明：该博客文章由作者通过「<a href=https://creativecommons.org/licenses/by/4.0/deed.zh>知识共享署名 4.0 许可证</a>」进行授权，转载须注明文章原始链接。</div></div></div></div><div class="col-lg-8 mx-auto block shadow"><h3>相关文章</h3><ul><li><a href=/posts/how-to-use-p6spy-in-spring-boot.html>如何在 Spring Boot 中使用 P6Spy 拦截 SQL 语句？</a></li><li><a href=/posts/how-to-use-spring-event.html>如何使用 Spring Event 实现内部模块间的轻松解耦？</a></li><li><a href=/posts/how-to-capture-entity-operations-in-spring-data-jpa.html>使用 Spring Data JPA 时如何捕捉实体的增删改操作？</a></li><li><a href=/posts/how-to-write-a-service-factory-in-spring-boot.html>在 Spring Boot 中如何优雅的编写一个服务工厂？</a></li><li><a href=/posts/spring-data-neo4j-database-config-error.html>Spring Data Neo4j 指定 spring.data.neo4j.database 时报错该如何解决？</a></li></ul></div><div class="col-lg-8 mx-auto block shadow"><div><h3>评论</h3><div id=comment-loading style=text-align:center;font-size:14px><img style=width:52px src=/static/images/site/mona-loading-default.gif>
<span>正在加载评论......</span></div><script>function handleMessage(e){if(e.origin!=="https://giscus.app")return;if(typeof e.data!="object"||!e.data.giscus)return;const t=document.getElementById("comment-loading");t.style.display="none"}window.addEventListener("message",handleMessage)</script><script src=https://giscus.app/client.js data-repo=leileiluoluo/leileiluoluo.github.io data-repo-id=R_kgDOJkLT8w data-category=General data-category-id=DIC_kwDOJkLT884CdtEh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></div></div></div></section><footer class="py-4 bg-lights border-top"><div class=container><div class="row justify-content-between text-center align-items-center"><div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0"></div><div class="col-lg-4 text-center mb-4 mb-lg-0"><ul class="list-inline mb-0"><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/sponsor>随喜打赏</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/about>关于本博</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/links>友情链接</a></li></ul></div><div class="col-lg-4 text-lg-right text-center mb-4 mb-lg-0"><ul class="list-inline social-icon mb-0"><li class=list-inline-item><a title=文章归档 href=/archives/><i class=ti-archive></i></a></li><li class=list-inline-item><a title=文章标签 href=/tags/><i class=ti-tag></i></a></li><li class=list-inline-item><a title="我的 GitHub" href=https://github.com/leileiluoluo><i class=ti-github></i></a></li><li class=list-inline-item><a title="网站 RSS" href=/index.xml><i class=ti-rss></i></a></li></ul></div></div><div style=text-align:center;margin-bottom:22px><a href=https://www.boyouquan.com/planet-shuttle target=_blank><img width=90px height=28px src=https://boyouquan.com/assets/images/sites/logo/planet-shuttle.svg></a></div><div class="text-center mt-4"><span>Made with <a href=https://gohugo.io/>Hugo</a> | Theme by <a href=https://github.com/themefisher/northendlab-hugo>NorthendLab</a> | <a href=https://beian.miit.gov.cn>辽ICP备2022012085号-5</a> | Copyright © 2017-2025</span></div></div></footer><script>var indexURL="https://leileiluoluo.github.io/index.json"</script><script src=https://leileiluoluo.github.io/js/jquery.min.js></script><script src=https://leileiluoluo.github.io/js/bootstrap.min.js></script><script src=https://leileiluoluo.github.io/js/fuse.min.js></script><script src=https://leileiluoluo.github.io/js/mark.js></script><script src=https://leileiluoluo.github.io/js/search.js></script><script src=https://leileiluoluo.github.io/js/script.min.js></script></body></html>