<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>Java 8 主要引入了哪些新特性？ - 磊磊落落</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="Java 8,新特性"><meta name=description content="我们知道 Java 8 是 Java 发布历史上一个里程碑式的版本，哪怕现在 Java 的最新版本已发展到 22，但仍有相当一部分企业在使用 Java 8，可以说 Java 8 是后续 Java 新版本得以快速迭代的基石。本文即重点回顾 Java 8 引入的那些主要特性，包括：Lambda 表达式、新的日期时间 API、Optional 类、支持在接口添加默认方法、Stream API、Base64 工具类等。"><meta name=author content="磊磊落落"><meta name=generator content="Hugo 0.123.7"><link rel=stylesheet href=https://leileiluoluo.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/themify-icons.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/larry-custom-v1.6.css><link rel=stylesheet href=https://leileiluoluo.github.io/scss/style.min.css media=screen><link rel="shortcut icon" href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><link rel=icon href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?526723b767317055572c85bdb445353c",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><header class="fixed-top navigation"><div class=container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><a class=navbar-brand href=https://leileiluoluo.github.io/>磊磊落落</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/></a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/>计算机</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E9%9A%8F%E7%AC%94/>随笔</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AF%BB%E4%B9%A6/>读书</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%A7%82%E5%BD%B1/>观影</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E7%BB%83%E5%AD%97/>练字</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/about>关于</a></li></ul><div class=search><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://leileiluoluo.github.io//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder=键入关键字后回车...></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><div class="py-5 d-none d-lg-block"></div><section class=section><div class=container><div class=row><div class="col-lg-8 mx-auto block shadow mb-5"><h1>Java 8 主要引入了哪些新特性？</h1><div class="mb-3 post-meta">2024年07月23日
<a href=/categories/%e8%ae%a1%e7%ae%97%e6%9c%ba>计算机</a></div><div class="content mb-5"><p>我们知道 Java 8 是 Java 发布历史上一个里程碑式的版本，哪怕现在 Java 的最新版本已发展到 22，但仍有相当一部分企业在使用 Java 8，可以说 Java 8 是后续 Java 新版本得以快速迭代的基石。本文即重点回顾 Java 8 引入的那些主要特性。</p><p><img loading=lazy src=https://leileiluoluo.github.io/static/images/uploads/2024/07/java-8-new-features.svg alt="Java 8 主要新特性脑图"></p><div style=text-align:center>（Java 8 主要新特性脑图）</div><h2 id=1-lambda-表达式>1 Lambda 表达式</h2><p>Lambda 表达式是 Java 8 引入的一个重要特性，其允许将代码块看作普通方法参数一样来进行传递。同时，Lambda 表达式使得匿名类的写法变得更加简洁。</p><p>Lambda 表达式的语法如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>(parameters)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>expression<span style=color:#bbb>
</span></span></span></code></pre></div><p>或者：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>(parameters)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb> </span>statements;<span style=color:#bbb> </span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>其中：</p><ul><li><code>parameters</code> 指定了 Lambda 表达式的参数列表。其可以为空，也可以为一个或多个参数。</li><li><code>-></code> 是 Lambda 操作符，其将参数列表与 Lambda 表达式的主体分隔开来。</li><li><code>expression</code> 可以是一个表达式或 Lambda 表达式的返回值。</li><li><code>{ statements; }</code> 包含了 Lambda 表达式的执行体，可以是单条语句或多条语句。</li></ul><p>Lambda 表达式的主要用途是简化函数式接口（只包含一个抽象方法，可使用 <code>@FunctionalInterface</code> 注解来检验）实例的创建。</p><p>下面使用一个小例子来演示 Lambda 表达式的使用。</p><p>如下代码声明了一个函数式接口 <code>MyInterface</code>，其只包含一个抽象方法，且使用 <code>@FunctionalInterface</code> 注解来标记：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/MyInterface.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@FunctionalInterface</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>MyInterface</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#998;font-style:italic>// 抽象方法</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>print</span>(String<span style=color:#bbb> </span>str);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#998;font-style:italic>// 默认方法</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>default</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>int</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>version</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>1;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#998;font-style:italic>// 静态方法</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>info</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#d14>&#34;functional interface test&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>需要注意的是，要满足函数式接口的定义，其内部只能包含一个抽象方法，但默认方法或静态方法的数量不受限制。再者，<code>@FunctionalInterface</code> 注解只用来校验接口是否满足定义，并不要求强制使用。</p><p>如下即是分别使用匿名内部类和 Lambda 表达式创建函数式接口实例的代码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/LambdaFeatureTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>LambdaFeatureTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用匿名类创建 Runnable 接口的实例</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Thread(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Runnable()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#3c5d5d;font-weight:700>@Override</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>run</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(<span style=color:#d14>&#34;a new thread started!&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}).<span style=color:teal>start</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用 Lambda 表达式创建 Runnable 接口的实例</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Thread(()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(<span style=color:#d14>&#34;a new thread started!&#34;</span>)).<span style=color:teal>start</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用匿名类创建 MyInterface 接口的实例</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>MyInterface<span style=color:#bbb> </span>myInterface1<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>MyInterface()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#3c5d5d;font-weight:700>@Override</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>print</span>(String<span style=color:#bbb> </span>str)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(str);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>};<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>myInterface1.<span style=color:teal>print</span>(<span style=color:#d14>&#34;my functional interface called&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用 Lambda 表达式创建 MyInterface 接口的实例</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>MyInterface<span style=color:#bbb> </span>myInterface2<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>System.<span style=color:teal>out</span>::println;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>myInterface2.<span style=color:teal>print</span>(<span style=color:#d14>&#34;my functional interface called&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>分析一下上述代码，因 <code>Runnable</code> 接口是一个函数式接口（其代码如下）。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>java.lang</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@FunctionalInterface</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>Runnable</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>abstract</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>run</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>因此，在 <code>main()</code> 方法的前两步，我们针对线程的创建，分别使用匿名内部类和 Lambda 表达式的方式创建了 <code>Runnable</code> 接口的实例。</p><p>接着，在 <code>main()</code> 方法的后两步，我们针对自定义的函数式接口 <code>MyInterface</code>，也分别使用匿名内部类和 Lambda 表达式的方式创建了其实例。可以看到，使用了 Lambda 表达式后的代码变得更加简洁和紧凑。</p><p>除了 <code>Runnable</code> 接口外，自 Java 8 起，诸多接口（如：<code>java.util.function.Predicate</code>、<code>java.util.Comparator</code>、<code>java.io.FileFilter</code> 等）均已标记为 <code>@FunctionalInterface</code> 接口。因此，针对这些接口的使用均可以换为对应 Lambda 表达式的写法。</p><h2 id=2-新的日期时间-api>2 新的日期时间 API</h2><p>因旧的日期相关的 API（诸如：<code>java.util.Date</code>、<code>java.util.Calendar</code>、<code>java.text.SimpleDateFormat</code> 等）存在非线程安全、类可变以及时区转换不够灵活等问题，Java 8 重新设计了日期时间 API（统一放在 <code>java.time</code> 包下），以更好地支持日期和时间的计算、格式化、解析和比较等操作。此外，<code>java.time</code> 包还提供了对日历系统的支持，包括对 <code>ISO-8601</code> 日历系统的全面支持。</p><p>下面列出 <code>java.time</code> 包中一些主要的类和接口：</p><ul><li><code>Instant</code>：表示时间线上的一个点，即一个瞬间，是一个不可变类，可以精确到纳秒级别。可以在忽略时区的情况下进行时间的表示、计算和比较。</li><li><code>LocalDate</code>：表示不包含时间信息的日期（如：年、月、日），不包含时区信息，也是一个不可变类。</li><li><code>LocalTime</code>：表示不包含日期信息的时间（如：时、分、秒），不包含时区信息，同为不可变类。</li><li><code>LocalDateTime</code>：表示日期和时间，不包含时区信息，同为不可变类。</li><li><code>ZonedDateTime</code>：表示包含时区信息的日期和时间，同为不可变类。</li><li><code>Duration</code>：表示时间间隔（如：几小时、几分钟、几秒），不可变类。</li><li><code>Period</code>：表示日期间隔（如：几年、几月、几日），不可变类。</li><li><code>DateTimeFormatter</code>：用于日期和时间的格式化和解析，不可变类。</li><li><code>ZoneId</code>：表示时区。</li><li><code>ZoneOffset</code>：表示时区偏移量，不可变类。</li></ul><p>下面使用一个简单的示例来演示新的日期时间 API 的使用：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/DateTimeAPITest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.time.*</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.time.format.DateTimeFormatter</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.concurrent.TimeUnit</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>DateTimeAPITest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>throws</span><span style=color:#bbb> </span>InterruptedException<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用 Instant 和 Duration 计算时间差</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Instant<span style=color:#bbb> </span>start<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Instant.<span style=color:teal>now</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>TimeUnit.<span style=color:teal>SECONDS</span>.<span style=color:teal>sleep</span>(1);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Instant<span style=color:#bbb> </span>end<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Instant.<span style=color:teal>now</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(Duration.<span style=color:teal>between</span>(start,<span style=color:#bbb> </span>end).<span style=color:teal>toSeconds</span>());<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用 LocalDate 计算下个月的今天，并使用 Period 计算两个日期的间隔月数</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>LocalDate<span style=color:#bbb> </span>localDate<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>LocalDate.<span style=color:teal>now</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>LocalDate<span style=color:#bbb> </span>localDateNextMonth<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>localDate.<span style=color:teal>plusMonths</span>(1);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(localDateNextMonth);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 2024-08-23</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Period<span style=color:#bbb> </span>period<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Period.<span style=color:teal>between</span>(localDate,<span style=color:#bbb> </span>localDateNextMonth);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(period.<span style=color:teal>getMonths</span>());<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 打印当前时区，获取当前 ZonedDateTime 并使用 DateTimeFormatter 格式化后进行打印；然后转换为洛杉矶 ZonedDateTime 并进行格式化和打印</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>DateTimeFormatter<span style=color:#bbb> </span>formatter<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>DateTimeFormatter.<span style=color:teal>ofPattern</span>(<span style=color:#d14>&#34;yyyy-MM-dd HH:mm:ss&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>ZoneId<span style=color:#bbb> </span>currentTimeZone<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>ZoneId.<span style=color:teal>systemDefault</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(currentTimeZone);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// &#34;Asia/Shanghai&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>ZonedDateTime<span style=color:#bbb> </span>shanghaiZonedDateTime<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>ZonedDateTime.<span style=color:teal>now</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(shanghaiZonedDateTime.<span style=color:teal>format</span>(formatter));<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 2024-07-23 13:08:15</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>ZonedDateTime<span style=color:#bbb> </span>losangelesZonedDateTime<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>shanghaiZonedDateTime.<span style=color:teal>withZoneSameInstant</span>(ZoneId.<span style=color:teal>of</span>(<span style=color:#d14>&#34;America/Los_Angeles&#34;</span>));<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(losangelesZonedDateTime.<span style=color:teal>format</span>(formatter));<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 2024-07-22 22:08:15</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，Java 8 新的日期时间 API 对于日期时间的获取、计算、格式化、时区转换等都有很好的支持。</p><h2 id=3-optional-类>3 Optional 类</h2><p>Java 8 引入一个新的 <code>Optional</code> 类，主要用于解决饱受诟病的 <code>NullPointerException</code> 问题。<code>java.util.Optional&lt;T></code> 类是一个容器类，其可以保存一个泛型的值 <code>T</code>，<code>T</code> 可以是一个非空 Java 对象，也可以是 <code>null</code>。</p><p>下面使用一个简单的例子看一下 <code>Optional</code> 是如何使用的：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/OptionalTest.java#main</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Optional<span style=color:#000;font-weight:700>&lt;</span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>optional<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Optional.<span style=color:teal>of</span>(<span style=color:#d14>&#34;hello&#34;</span>);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// Optional.ofNullable(null);</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>if</span><span style=color:#bbb> </span>(optional.<span style=color:teal>isPresent</span>())<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>String<span style=color:#bbb> </span>message<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>optional.<span style=color:teal>get</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(message);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb> </span><span style=color:#000;font-weight:700>else</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(<span style=color:#d14>&#34;message is null&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，<code>Optional</code> 类可以对真实的对象进行包装。<code>Optional</code> 中的值可以是一个非 <code>null</code> 值，也可以是一个 <code>null</code> 值。因 <code>Optional</code> 构造方法是私有的，创建 <code>Optional</code> 对象时可以使用 <code>Optional.of()</code> 或 <code>Optional.ofNullable()</code> 工厂方法来实现。使用 <code>Optional.of()</code> 方法创建对象时，传入的值不可以为 <code>null</code>（否则会抛出 <code>NullPointerException</code>），而使用 <code>Optional.ofNullable()</code> 方法创建对象时，传入的值可以为 <code>null</code>。</p><p>在使用 <code>Optional</code> 类时，可以先通过其 <code>isPresent()</code> 方法判断值是否存在，如果存在则可以通过 <code>get()</code> 方法获取该值，这样即避免了 <code>NullPointerException</code> 的发生。</p><p><code>Optional</code> 类除了可以避免 <code>NullPointerException</code> 的发生外，还支持一系列链式写法，从而使代码更加简洁紧凑。</p><p>下面的示例代码包含两个类：<code>Order</code> 与 <code>Customer</code>，两者是一种嵌套关系，即 <code>Order</code> 中有一个 <code>Customer</code>，<code>Customer</code> 中有一个 <code>address</code> 字段。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/OptionalTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>Order</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>final</span><span style=color:#bbb> </span>Customer<span style=color:#bbb> </span>customer;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>Order</span>(Customer<span style=color:#bbb> </span>customer)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>this</span>.<span style=color:teal>customer</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>customer;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span>Customer<span style=color:#bbb> </span><span style=color:#900;font-weight:700>getCustomer</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>this</span>.<span style=color:teal>customer</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>Customer</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>final</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>address;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>Customer</span>(String<span style=color:#bbb> </span>address)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>this</span>.<span style=color:teal>address</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>address;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>getAddress</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>this</span>.<span style=color:teal>address</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>如果我们想编写一个方法来获取 <code>Order</code> 的 <code>address</code> 信息，常规的包含 <code>null</code> 检查的写法可以是下面这个样子：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/OptionalTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>getOrderAddress</span>(Order<span style=color:#bbb> </span>order)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>if</span><span style=color:#bbb> </span>(<span style=color:#000;font-weight:700>null</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>==</span><span style=color:#bbb> </span>order<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>||</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>null</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>==</span><span style=color:#bbb> </span>order.<span style=color:teal>getCustomer</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>||</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>null</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>==</span><span style=color:#bbb> </span>order.<span style=color:teal>getCustomer</span>().<span style=color:teal>getAddress</span>())<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>throw</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>RuntimeException(<span style=color:#d14>&#34;Invalid Order&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>order.<span style=color:teal>getCustomer</span>().<span style=color:teal>getAddress</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>如果换作使用 <code>Optional</code> 类来包装并进行链式操作呢？写法会变成下面的样子：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/OptionalTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>getOrderAddressUsingOptional</span>(Order<span style=color:#bbb> </span>order)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>Optional.<span style=color:teal>ofNullable</span>(order)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>.<span style=color:teal>map</span>(Order::getCustomer)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>.<span style=color:teal>map</span>(Customer::getAddress)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>.<span style=color:teal>orElseThrow</span>(()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>RuntimeException(<span style=color:#d14>&#34;Invalid Order&#34;</span>));<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，使用 <code>Optional</code> 类后，代码变为了一行，且更加直观明了。</p><p>所以，在 Java 8 引入 <code>Optional</code> 类后，我们可以对可空对象进行包装，从而避免空指针的发生，也可以借助<code>Optional</code> 类提供的链式方法编写出更加紧凑的代码。</p><h2 id=4-支持在接口添加默认方法>4 支持在接口添加默认方法</h2><p>在 Java 8 之前，接口中定义的变量必须是 <code>public static final</code> 的，定义的方法必须是 <code>public abstract</code> 的。我们知道，接口的设计需要「深思熟虑」，因为在接口中新增一个方法，需要对它的所有实现类都进行修改，对于实现类比较多的情况，涉及的工作量非常巨大。</p><p>为了解决这个问题，Java 8 支持在接口添加默认方法（使用 <code>default</code> 关键字定义），其使得接口可以包含方法的实现，而不仅仅是抽象方法的定义。</p><p>默认方法允许接口在不破坏实现类的情况下进行演进。这对于标准化库的维护和扩展非常有用，因为可以为接口添加新的方法来满足新的需求，而不会影响已有的实现。同时，默认方法使得接口可以通过通用方法实现，这可以减少代码的重复性，提供了代码的可维护性，这时的接口就有点像抽象类了。</p><p>此外，Java 8 还支持在接口中定义静态方法，非常适用于被用作工具方法的场景。</p><p>下面即是一个在接口中定义默认方法和静态方法的例子：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/InterfaceWithDefaultMethodsTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>InterfaceWithDefaultMethodsTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>Animal</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>greeting</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>default</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>firstMeet</span>(String<span style=color:#bbb> </span>someone)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(greeting()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>+</span><span style=color:#bbb> </span><span style=color:#d14>&#34;，&#34;</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>+</span><span style=color:#bbb> </span>someone);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>sleep</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(<span style=color:#d14>&#34;呼呼呼&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>Cat</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>implements</span><span style=color:#bbb> </span>Animal<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#3c5d5d;font-weight:700>@Override</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>greeting</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#d14>&#34;喵喵喵&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>Dog</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>implements</span><span style=color:#bbb> </span>Animal<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#3c5d5d;font-weight:700>@Override</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>greeting</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#d14>&#34;汪汪汪&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Animal<span style=color:#bbb> </span>cat<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Cat();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(cat.<span style=color:teal>greeting</span>());<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 喵喵喵</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>cat.<span style=color:teal>firstMeet</span>(<span style=color:#d14>&#34;主人&#34;</span>);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 喵喵喵，主人</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Animal<span style=color:#bbb> </span>dog<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Dog();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(dog.<span style=color:teal>greeting</span>());<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 汪汪汪</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>dog.<span style=color:teal>firstMeet</span>(<span style=color:#d14>&#34;主人&#34;</span>);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 汪汪汪，主人</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Animal.<span style=color:teal>sleep</span>();<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 呼呼呼</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>上面的代码中，<code>Animal</code> 接口拥有一个抽象方法 <code>greeting()</code>、一个默认方法 <code>firstMeet()</code> 和一个静态方法 <code>sleep()</code>，除抽象方法外，其它两个方法均拥有自己的实现。<code>Animal</code> 接口的实现类 <code>Cat</code> 和 <code>Dog</code> 必须实现其抽象方法 <code>greeting()</code>，而无须实现其默认方法 <code>firstMeet()</code>。对于其静态方法 <code>sleep()</code>，与类的静态方法无异，直接使用类名方式调用即可。</p><h2 id=5-stream-api>5 Stream API</h2><p>Java 8 新添加的 Stream API 提供了一种更简洁和强大的处理集合数据的方式。使用 Stream API，我们可以对集合数据进行一系列的流水线操作（如：筛选、映射、过滤和排序等）来高效地处理数据。</p><p>Stream API 性能很好，因为其求值是惰性的，即其操作分中间操作（<code>filter</code>、<code>map</code>、<code>distinct</code>、<code>sorted</code>、<code>limit</code>、<code>skip</code> 等）和终端操作（<code>forEach</code>、<code>collect</code>、<code>reduce</code>、<code>count</code> 等），而只有在调用终端操作时才会真正执行所有的中间操作链。</p><p>下面看一下使用 Stream API 的例子：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/StreamAPITest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.List</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.stream.IntStream</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>StreamAPITest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 生成一个 [1, 2, ..., 100] 的数组，然后对每个元素求平方后进行求和</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#458;font-weight:700>long</span><span style=color:#bbb> </span>sum<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>IntStream.<span style=color:teal>rangeClosed</span>(0,<span style=color:#bbb> </span>100)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>mapToLong</span>(num<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>(<span style=color:#458;font-weight:700>long</span>)<span style=color:#bbb> </span>num<span style=color:#bbb> </span><span style=color:#000;font-weight:700>*</span><span style=color:#bbb> </span>num)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>sum</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(sum);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 对 List 进行过滤、映射、排序后进行打印</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>List<span style=color:#000;font-weight:700>&lt;</span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>languages<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>List.<span style=color:teal>of</span>(<span style=color:#d14>&#34;java&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;golang&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;python&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;php&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;javascript&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>languages.<span style=color:teal>stream</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>filter</span>(lang<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>lang.<span style=color:teal>length</span>()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#bbb> </span>8)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>map</span>(String::toUpperCase)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>sorted</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>forEach</span>(System.<span style=color:teal>out</span>::println);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，第一个例子生成了一个 <code>[1, 100]</code> 的 <code>IntStream</code>，然后对该 <code>IntStream</code> 使用 <code>mapToLong()</code> 对每个元素进行了求平方并转型为了 <code>long</code> 类型，最后计算了所有元素的总和；第二个例子针对一个 <code>List&lt;String></code> 的 <code>stream()</code>，作了过滤、映射、排序后调用 <code>forEach()</code> 作了打印。</p><h2 id=6-base64-工具类>6 Base64 工具类</h2><p>Base64 算法是一种常用的编码方法，它可以将任意的二进制数据转换成纯文本字符串的形式，使得二进制数据可以在文本协议中传输或存储。</p><p>在 Java 8 之前，我们需要依赖第三方库来实现 Base64 编码解码。为了能够提供一个标准的、更加安全的方法来进行 Base64 的编码和解码操作，使得开发者们不再需要依赖外部库，Java 8 添加了标准的 Base64 工具类。</p><p>下面即看一下该工具类如何使用：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/Base64Test.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.Base64</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>Base64Test</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span>text<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;java8&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span>encoded<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Base64.<span style=color:teal>getEncoder</span>().<span style=color:teal>encodeToString</span>(text.<span style=color:teal>getBytes</span>());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(encoded);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// amF2YTg=</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#458;font-weight:700>byte</span><span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>decoded<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Base64.<span style=color:teal>getDecoder</span>().<span style=color:teal>decode</span>(encoded);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>String(decoded));<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// java8</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span>url<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;https://leileiluoluo.com/posts/java-8-new-features.html&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span>urlEncoded<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Base64.<span style=color:teal>getUrlEncoder</span>().<span style=color:teal>encodeToString</span>(url.<span style=color:teal>getBytes</span>());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(urlEncoded);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// aHR0cHM6Ly9sZWlsZWlsdW9sdW8uY29tL3Bvc3RzL2phdmEtOC1uZXctZmVhdHVyZXMuaHRtbA==</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#458;font-weight:700>byte</span><span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>urlDecoded<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Base64.<span style=color:teal>getUrlDecoder</span>().<span style=color:teal>decode</span>(urlEncoded);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>String(urlDecoded));<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// https://leileiluoluo.com/posts/java-8-new-features.html</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，需要对文本或 URL 进行 Base64 编码、解码时，需要先拿到对应的 <code>Encoder</code> 或 <code>Decoder</code>，然后调用其 <code>encode()</code> 或 <code>decode()</code> 方法即可实现编码、解码工作。</p><h2 id=7-方法引用和构造器引用>7 方法引用和构造器引用</h2><p>Java 8 引入的方法引用可以进一步简化 Lambda 表达式的编写。方法引用的本质是可以提供一种简洁的方式引用类或者实例的方法（包括构造器方法），引用格式为：<code>类名::方法名</code>、<code>实例名::方法名</code>。</p><p>下面看一下我们在前面介绍 Stream API 时用到的一个例子：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/MethodReferenceTest.java#main</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>List<span style=color:#000;font-weight:700>&lt;</span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>languages<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>List.<span style=color:teal>of</span>(<span style=color:#d14>&#34;java&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;golang&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;python&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;php&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;javascript&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>languages.<span style=color:teal>stream</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:teal>map</span>(String::toUpperCase)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:teal>forEach</span>(System.<span style=color:teal>out</span>::println);<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，上述 <code>main()</code> 方法中对 <code>languages</code> 列表中的元素进行了流式操作，即对每一个元素进行大写字母转换后进行了打印。这里的 <code>String::toUpperCase</code> 与 <code>System.out::println</code> 均为方法引用。</p><p>而不使用方法引用的话，这段代码该怎么写呢？可以是下面这个样子：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>List<span style=color:#000;font-weight:700>&lt;</span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>languages<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>List.<span style=color:teal>of</span>(<span style=color:#d14>&#34;java&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;golang&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;python&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;php&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;javascript&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>languages.<span style=color:teal>stream</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:teal>map</span>((lang)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>lang.<span style=color:teal>toUpperCase</span>())<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:teal>forEach</span>((lang)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(lang));<span style=color:#bbb>
</span></span></span></code></pre></div><p>但并不是所有的 Lambda 表达式都有对应的方法引用简写方式，可否将 Lambda 表达式写法转换为方法引用写法是有限制的。限制是：Lambda 表达式中仅有一个方法调用，且方法引用的目标方法的参数数量、参数类型以及返回类型必须与函数接口的要求完全匹配。</p><p>方法引用支持的方法不仅可以是静态方法、实例方法，还可以是构造方法（引用格式为：<code>类名::new</code>），甚至还支持数组引用（引用格式为：<code>Type[]::new</code>）。</p><p>下面看一段示例代码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/MethodReferenceTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.List</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.stream.Collectors</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>MethodReferenceTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>Language</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>final</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>name;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>Language</span>(String<span style=color:#bbb> </span>name)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>this</span>.<span style=color:teal>name</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>name;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>List<span style=color:#000;font-weight:700>&lt;</span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>languages<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>List.<span style=color:teal>of</span>(<span style=color:#d14>&#34;java&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;golang&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;python&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;php&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;javascript&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Language<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>languageArray<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>languages.<span style=color:teal>stream</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>map</span>(Language::<span style=color:#000;font-weight:700>new</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>toArray</span>(Language<span style=color:#000;font-weight:700>[]</span>::<span style=color:#000;font-weight:700>new</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>上面代码中的 <code>map(Language::new).toArray(Language[]::new)</code> 即使用了构造方法引用和数组引用。</p><h2 id=8-类型注解>8 类型注解</h2><p>Java 8 之前，注解仅可以标记在类、方法、字段上。为了便于注解用于增强代码分析、编译期检查等场景的能力，Java 8 引入了类型注解，这样注解将不仅能应用于声明，还能应用于任何使用类型的地方。</p><p>看一段示例代码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>printLength</span>(<span style=color:#3c5d5d;font-weight:700>@NonNull</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>str)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(str.<span style=color:teal>length</span>());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>List<span style=color:#000;font-weight:700>&lt;</span><span style=color:#3c5d5d;font-weight:700>@Nonnull</span><span style=color:#bbb> </span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>languages<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>ArrayList<span style=color:#000;font-weight:700>&lt;&gt;</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>languages.<span style=color:teal>add</span>(<span style=color:#000;font-weight:700>null</span>);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>//  Adding &#39;null&#39; element to parameter annotated as @NotNull</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>printLength(<span style=color:#000;font-weight:700>null</span>);<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// Passing &#39;null&#39; argument to parameter annotated as @NotNull</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>上述代码中，<code>languages</code> List 的参数被标记为 <code>@Nonnull</code>，试图在该 List 加入一个 <code>null</code> 值时会有编译器错误。同理，<code>printLength()</code> 方法的参数也被标记为 <code>@NonNull</code>，试图传入一个 <code>null</code> 值时也会报编译器错误。</p><h2 id=9-类型推断>9 类型推断</h2><p>Java 8 引入了针对 Lambda 表达式的参数类型推断，使得在大多数情况下可以省略参数类型的显式声明。</p><p>看一段示例代码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/TypeInferenceTest.java#main</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>List<span style=color:#000;font-weight:700>&lt;</span>String<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>names<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Arrays.<span style=color:teal>asList</span>(<span style=color:#d14>&#34;Alice&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;Bob&#34;</span>,<span style=color:#bbb> </span><span style=color:#d14>&#34;Charlie&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>names.<span style=color:teal>sort</span>((o1,<span style=color:#bbb> </span>o2)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>o1.<span style=color:teal>compareTo</span>(o2));<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// names.sort((String o1, String o2) -&gt; o1.compareTo(o2));</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>上述代码对 <code>names</code> List 进行排序时，传入的 Lambda 表达式为 <code>(o1, o2) -> o1.compareTo(o2)</code> 而非 <code>(String o1, String o2) -> o1.compareTo(o2)</code>，这是因为编译器会自动推断参数的类型，从而可以省略参数类型的显式声明。</p><h2 id=10-可重复注解-repeatable>10 可重复注解 @Repeatable</h2><p>在 Java 8 中，引入了 <code>@Repeatable</code> 注解用于支持注解的多次标记。这个特性允许我们在同一个目标上多次使用同一个注解，而无需使用容器注解来包装多个注解实例。</p><p>如在 Java 8 之前，在一个类上对一个注解进行多次标记是不允许的：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#3c5d5d;font-weight:700>@PropertySource</span>(<span style=color:#d14>&#34;classpath:config.properties&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@PropertySource</span>(<span style=color:#d14>&#34;classpath:application.properties&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>PropertyConfig</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>为解决该问题，我们必须定义一个注解的容器：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#3c5d5d;font-weight:700>@interface</span><span style=color:#bbb> </span>PropertySources<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>PropertySource<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>value</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>然后使用容器注解来进行标记：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#3c5d5d;font-weight:700>@PropertySources</span>({<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#3c5d5d;font-weight:700>@PropertySource</span>(<span style=color:#d14>&#34;classpath:config.properties&#34;</span>),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#3c5d5d;font-weight:700>@PropertySource</span>(<span style=color:#d14>&#34;classpath:application.properties&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>})<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>PropertyConfig</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>而借助 Java 8 引入的 <code>@Repeatable</code> 注解，我们可以轻而易举的解决这个问题：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#3c5d5d;font-weight:700>@Repeatable</span>(PropertySource.<span style=color:teal>class</span>)<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 声明可重复注解</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#3c5d5d;font-weight:700>@interface</span><span style=color:#bbb> </span>PropertySource<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>这样，加了 <code>@Repeatable</code> 注解的 <code>@PropertySource</code> 即可供我们重复使用了：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#3c5d5d;font-weight:700>@PropertySource</span>(<span style=color:#d14>&#34;classpath:config.properties&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@PropertySource</span>(<span style=color:#d14>&#34;classpath:application.properties&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>PropertyConfig</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h2 id=11-实用并发工具的扩展>11 实用并发工具的扩展</h2><p>Java 8 对 <code>java.util.concurrent</code> 包下的并发工具类做了一些扩展，以提供更强大、更灵活的并发编程能力。</p><h3 id=completablefuture>CompletableFuture</h3><p>CompletableFuture 是一种用于异步编程的强大工具，其提供了一种方便的方式（回调、组合、转换等）来管理多个异步操作的结果。</p><p>下面简单看一下 <code>ComplatableFuture</code> 类的使用：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/CompletableFutureTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.concurrent.*</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>CompletableFutureTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用 CompletableFuture 进行异步计算</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>CompletableFuture<span style=color:#000;font-weight:700>&lt;</span>Integer<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>future1<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>CompletableFuture.<span style=color:teal>supplyAsync</span>(()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>try</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span><span style=color:#998;font-style:italic>// 模拟耗时操作</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>TimeUnit.<span style=color:teal>SECONDS</span>.<span style=color:teal>sleep</span>(1);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb> </span><span style=color:#000;font-weight:700>catch</span><span style=color:#bbb> </span>(InterruptedException<span style=color:#bbb> </span>e)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>e.<span style=color:teal>printStackTrace</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>42;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>});<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>CompletableFuture<span style=color:#000;font-weight:700>&lt;</span>Integer<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>future2<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>CompletableFuture.<span style=color:teal>supplyAsync</span>(()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>try</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>TimeUnit.<span style=color:teal>SECONDS</span>.<span style=color:teal>sleep</span>(2);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb> </span><span style=color:#000;font-weight:700>catch</span><span style=color:#bbb> </span>(InterruptedException<span style=color:#bbb> </span>e)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>e.<span style=color:teal>printStackTrace</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>100;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>});<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 使用 CompletableFuture 处理异步计算结果，这里需要两个任务都完成</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>CompletableFuture<span style=color:#000;font-weight:700>&lt;</span>Integer<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>allFutures<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>CompletableFuture.<span style=color:teal>allOf</span>(future1,<span style=color:#bbb> </span>future2)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>thenApply</span>(result<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>future1.<span style=color:teal>join</span>()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>+</span><span style=color:#bbb> </span>future2.<span style=color:teal>join</span>());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 等待所有任务完成</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(allFutures.<span style=color:teal>join</span>());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>上述示例中，首先使用 <code>CompletableFuture</code> 创建了两个异步任务 <code>future1</code> 和 <code>future2</code>，然后使用 <code>CompletableFuture.allOf(future1, future2);</code> 等待两个任务并发执行完成后调用 <code>thenApply()</code> 获取两个任务的合并结果，最后在主线程使用 <code>join()</code> 方法等待所有任务执行完成。</p><h3 id=longadder-与-doubleadder>LongAdder 与 DoubleAdder</h3><p><code>LongAdder</code> 与 <code>DoubleAdder</code> 类是对 <code>AtomicLong</code> 和 <code>AtomicDouble</code> 类的改进，提供了更高的并发性能。<code>LongAdder</code> 与 <code>DoubleAdder</code> 类通过分解内部计数器，将更新操作分散到多个变量上，减少了竞争和锁争用。</p><p>看一个示例：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#998;font-style:italic>// src/main/java/AdderTest.java</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.concurrent.atomic.DoubleAdder</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#555>java.util.concurrent.atomic.LongAdder</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>AdderTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>static</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>main</span>(String<span style=color:#000;font-weight:700>[]</span><span style=color:#bbb> </span>args)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>throws</span><span style=color:#bbb> </span>InterruptedException<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>LongAdder<span style=color:#bbb> </span>longAdder<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>LongAdder();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>DoubleAdder<span style=color:#bbb> </span>doubleAdder<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>DoubleAdder();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 启动一个线程循环自增 100 次</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>Thread<span style=color:#bbb> </span>thread<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Thread(()<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>for</span><span style=color:#bbb> </span>(<span style=color:#458;font-weight:700>int</span><span style=color:#bbb> </span>i<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>0;<span style=color:#bbb> </span>i<span style=color:#bbb> </span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#bbb> </span>100;<span style=color:#bbb> </span>i<span style=color:#000;font-weight:700>++</span>)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>longAdder.<span style=color:teal>increment</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>doubleAdder.<span style=color:teal>add</span>(0.<span style=color:teal>5</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>});<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>thread.<span style=color:teal>start</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 在主线程循环自增 100 次</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>for</span><span style=color:#bbb> </span>(<span style=color:#458;font-weight:700>int</span><span style=color:#bbb> </span>i<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>0;<span style=color:#bbb> </span>i<span style=color:#bbb> </span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#bbb> </span>100;<span style=color:#bbb> </span>i<span style=color:#000;font-weight:700>++</span>)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>longAdder.<span style=color:teal>increment</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>doubleAdder.<span style=color:teal>add</span>(0.<span style=color:teal>5</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 等待 thread 执行完成</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>thread.<span style=color:teal>join</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#998;font-style:italic>// 打印自增结果</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(longAdder.<span style=color:teal>sum</span>());<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 200</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>System.<span style=color:teal>out</span>.<span style=color:teal>println</span>(doubleAdder.<span style=color:teal>sum</span>());<span style=color:#bbb> </span><span style=color:#998;font-style:italic>// 100.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>上述示例中，首先创建了 <code>LongAdder</code> 与 <code>DoubleAdder</code> 实例，然后分别在一个新线程、主线程并发「循环自增 100 次」，打印结果，发现最后的 <code>sum</code> 值准确无误。</p><p>综上，我们速览了 Java 8 引入的一些主要特性。本文涉及的所有示例代码已提交至 <a href=https://github.com/leileiluoluo/java-exercises/tree/main/java-8-new-features-demo/src/main/java>GitHub</a>，欢迎关注或 Fork。</p><blockquote><p>参考资料</p><p>[1] Oracle: What&rsquo;s New in JDK 8? - <a href=https://www.oracle.com/java/technologies/javase/8-whats-new.html>https://www.oracle.com/java/technologies/javase/8-whats-new.html</a></p><p>[2] 掘金：一口气读完 Java 8 ~ Java 21 所有新特性 - <a href=https://juejin.cn/post/7315730050577006592>https://juejin.cn/post/7315730050577006592</a></p><p>[3] 掘金：JDK 8 - JDK 17 新特性总结 - <a href=https://juejin.cn/post/7250734439709048869>https://juejin.cn/post/7250734439709048869</a></p></blockquote></div><div class=content-footer><div class=weixinhao><img src=/static/images/self/weixinhao-white.jpg></div><div class=post-tags><a href=/tags/java/>#Java</a></div><div class=license><i class=ti-info-alt></i><div class=info>版权声明：该博客文章由作者通过「<a href=https://creativecommons.org/licenses/by/4.0/deed.zh>知识共享署名 4.0 许可证</a>」进行授权，转载须注明文章原始链接。</div></div></div></div><div class="col-lg-8 mx-auto block shadow"><h3>相关文章</h3><ul><li><a href=/posts/spring-data-neo4j.html>如何使用 Spring Data Neo4j 访问 Neo4j 数据库？</a></li><li><a href=/posts/boyouquan-v2-introduction.html>博友圈 v2 版本技术架构</a></li><li><a href=/posts/spring-boot-and-thymeleaf-integration.html>Spring Boot 集成 Thymeleaf 搭建 Web 应用</a></li><li><a href=/posts/spring-cloud-config-server-setup.html>如何搭建 Spring Cloud 统一配置服务？</a></li><li><a href=/posts/java-13-new-features.html>Java 13 主要引入了哪些新特性？</a></li></ul></div><div class="col-lg-8 mx-auto block shadow"><div><h3>评论</h3><div id=comment-loading style=text-align:center;font-size:14px><img style=width:52px src=/static/images/site/mona-loading-default.gif>
<span>正在加载评论......</span></div><script>function handleMessage(e){if(e.origin!=="https://giscus.app")return;if(typeof e.data!="object"||!e.data.giscus)return;const t=document.getElementById("comment-loading");t.style.display="none"}window.addEventListener("message",handleMessage)</script><script src=https://giscus.app/client.js data-repo=leileiluoluo/leileiluoluo.github.io data-repo-id=R_kgDOJkLT8w data-category=General data-category-id=DIC_kwDOJkLT884CdtEh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></div></div></div></section><footer class="py-4 bg-lights border-top"><div class=container><div class="row justify-content-between text-center align-items-center"><div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0"></div><div class="col-lg-4 text-center mb-4 mb-lg-0"><ul class="list-inline mb-0"><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/sponsor>随喜打赏</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/about>关于本博</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/links>友情链接</a></li></ul></div><div class="col-lg-4 text-lg-right text-center mb-4 mb-lg-0"><ul class="list-inline social-icon mb-0"><li class=list-inline-item><a title=文章归档 href=/archives/><i class=ti-archive></i></a></li><li class=list-inline-item><a title=文章标签 href=/tags/><i class=ti-tag></i></a></li><li class=list-inline-item><a title="我的 GitHub" href=https://github.com/leileiluoluo><i class=ti-github></i></a></li><li class=list-inline-item><a title="网站 RSS" href=/index.xml><i class=ti-rss></i></a></li></ul></div></div><div style=text-align:center;margin-bottom:22px><a href=https://www.boyouquan.com/planet-shuttle target=_blank><img width=90px height=28px src=https://boyouquan.com/assets/images/sites/logo/planet-shuttle.svg></a></div><div class="text-center mt-4"><span>Made with <a href=https://gohugo.io/>Hugo</a> | Theme by <a href=https://github.com/themefisher/northendlab-hugo>NorthendLab</a> | <a href=https://beian.miit.gov.cn>辽ICP备2022012085号-5</a> | Copyright © 2017-2025</span></div></div></footer><script>var indexURL="https://leileiluoluo.github.io/index.json"</script><script src=https://leileiluoluo.github.io/js/jquery.min.js></script><script src=https://leileiluoluo.github.io/js/bootstrap.min.js></script><script src=https://leileiluoluo.github.io/js/fuse.min.js></script><script src=https://leileiluoluo.github.io/js/mark.js></script><script src=https://leileiluoluo.github.io/js/search.js></script><script src=https://leileiluoluo.github.io/js/script.min.js></script></body></html>