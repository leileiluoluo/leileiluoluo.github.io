<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>如何在 Spring Boot 中使用 P6Spy 拦截 SQL 语句？ - 磊磊落落</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="Java,Spring,P6Spy,拦截,SQL"><meta name=description content="P6Spy 是一个用于拦截和记录应用程序和数据库之间的所有 JDBC 操作的开源 Java 库。P6Spy 是无代码侵入的，也就是说，我们无需修改应用程序代码，只需做一些简单的配置，即可使用 P6Spy 这个横在应用程序和 JDBC 驱动之间的「间谍」来捕获所有使用的 SQL 语句和其执行细节。本文先简单介绍一下 P6Spy 的工作原理，然后以在 Spring Boot 中使用 P6Spy 拦截 SQL 语句为例来演示 P6Spy 的基本功能和使用方式。"><meta name=author content="磊磊落落"><meta name=generator content="Hugo 0.123.7"><link rel=stylesheet href=https://leileiluoluo.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/themify-icons.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/larry-custom-v1.6.css><link rel=stylesheet href=https://leileiluoluo.github.io/scss/style.min.css media=screen><link rel="shortcut icon" href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><link rel=icon href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?526723b767317055572c85bdb445353c",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><header class="fixed-top navigation"><div class=container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><a class=navbar-brand href=https://leileiluoluo.github.io/>磊磊落落</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/></a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/>计算机</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E9%9A%8F%E7%AC%94/>随笔</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AF%BB%E4%B9%A6/>读书</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%A7%82%E5%BD%B1/>观影</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E7%BB%83%E5%AD%97/>练字</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/about>关于</a></li></ul><div class=search><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://leileiluoluo.github.io//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder=键入关键字后回车...></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><div class="py-5 d-none d-lg-block"></div><section class=section><div class=container><div class=row><div class="col-lg-8 mx-auto block shadow mb-5"><h1>如何在 Spring Boot 中使用 P6Spy 拦截 SQL 语句？</h1><div class="mb-3 post-meta">2025年08月31日
<a href=/categories/%e8%ae%a1%e7%ae%97%e6%9c%ba>计算机</a></div><div class="content mb-5"><p>P6Spy 是一个用于拦截和记录应用程序和数据库之间的所有 JDBC 操作的开源 Java 库。P6Spy 是无代码侵入的，也就是说，我们无需修改应用程序代码，只需做一些简单的配置，即可使用 P6Spy 这个横在应用程序和 JDBC 驱动之间的「间谍」来捕获所有使用的 SQL 语句和其执行细节。</p><p>因 P6Spy 是在 JDBC 层工作，所以不论我们使用的是市面上哪一款基于 JDBC 之上的 ORM 框架（如：Hibernate、MyBatis），P6Spy 都能很好的捕捉到最终生成的 SQL。</p><p>有了 P6Spy 这个工具，我们就可以很好的找出应用程序中的慢查询 SQL 语句、高频 SQL 语句，从而为数据库优化提供数据支持。此外，P6Spy 还适用于安全审计或数据变更追踪等场景。</p><p>本文先简单介绍一下 P6Spy 的工作原理，然后以在 Spring Boot 中使用 P6Spy 拦截 SQL 语句为例来演示 P6Spy 的基本功能和使用方式。</p><h2 id=1-p6spy-工作原理>1 P6Spy 工作原理</h2><p>正如本文开头所提到的，P6Spy 在 JDBC 层工作，像一个间谍一样「劫持」了 <code>DriverManager</code>，将真实的 JDBC 连接（如：<code>jdbc:mysql//localhost/db</code>）替换为了 P6Spy 的连接（如：<code>jdbc:p6spy:mysql//localhost/db</code>）；并将真实的驱动类（如：<code>com.mysql.cj.jdbc.Driver</code>）替换为了 P6Spy 的驱动类（<code>com.p6spy.engine.spy.P6SpyDriver</code>）。这样，应用程序针对数据库的所有调用，都会被 P6Spy 所拦截和处理，所以 P6Spy 可以很容易的捕获到执行的 SQL、耗时情况等信息。</p><h2 id=2-在-spring-boot-中使用-p6spy>2 在 Spring Boot 中使用 P6Spy</h2><p>下面，尝试在 Spring Boot 中使用 P6Spy，本文示例工程使用的 ORM 框架是 JPA，使用的数据库为 MySQL。</p><p>写作本文时，使用的 Java、Spring Boot、P6Spy 的版本为：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Java: 17
</span></span><span style=display:flex><span>Spring Boot: 3.5.5
</span></span><span style=display:flex><span>P6Spy: 3.9.1
</span></span></code></pre></div><h3 id=21-引入-maven-依赖>2.1 引入 Maven 依赖</h3><p>在 Spring Boot 中使用 P6Spy 非常的简单，只需引入一个 <code>p6spy-spring-boot-starter</code> 依赖即可。下面即是我们的示例工程用到的主要依赖，有 JPA、Lombok、MySQL Connector 和 P6Spy Starter。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:navy>&lt;dependencies&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>org.springframework.boot<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>spring-boot-starter-web<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>org.springframework.boot<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>org.projectlombok<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>lombok<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;version&gt;</span>1.18.38<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;scope&gt;</span>provided<span style=color:navy>&lt;/scope&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic>&lt;!-- driver --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>com.mysql<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>mysql-connector-j<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;version&gt;</span>9.4.0<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;scope&gt;</span>runtime<span style=color:navy>&lt;/scope&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic>&lt;!-- p6spy --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;groupId&gt;</span>com.github.gavlyukovskiy<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;artifactId&gt;</span>p6spy-spring-boot-starter<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;version&gt;</span>1.12.0<span style=color:navy>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;/dependencies&gt;</span>
</span></span></code></pre></div><h3 id=22-建表建-entity建-repository>2.2 建表、建 Entity、建 Repository</h3><p>本示例工程使用的数据库为 MySQL，我们希望 P6Spy 帮助捕获 User 的增删改查操作，所以需要建一个 <code>user</code> 表：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#000;font-weight:700>DROP</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>TABLE</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>IF</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>EXISTS</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>user</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>TABLE</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>user</span><span style=color:#bbb> </span>(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>id<span style=color:#bbb> </span><span style=color:#0086b3>BIGINT</span><span style=color:#bbb> </span>AUTO_INCREMENT<span style=color:#bbb> </span><span style=color:#000;font-weight:700>PRIMARY</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>KEY</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>name<span style=color:#bbb> </span><span style=color:#0086b3>VARCHAR</span>(<span style=color:#099>20</span>)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>email<span style=color:#bbb> </span><span style=color:#0086b3>VARCHAR</span>(<span style=color:#099>20</span>)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>year_of_birth<span style=color:#bbb> </span><span style=color:#0086b3>INT</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>created_at<span style=color:#bbb> </span><span style=color:#000;font-weight:700>TIMESTAMP</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NULL</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>DEFAULT</span><span style=color:#bbb> </span><span style=color:#d14>&#39;2025-01-01 00:00:00&#39;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>updated_at<span style=color:#bbb> </span><span style=color:#000;font-weight:700>TIMESTAMP</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>NULL</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>DEFAULT</span><span style=color:#bbb> </span><span style=color:#d14>&#39;2025-01-01 00:00:00&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>);<span style=color:#bbb>
</span></span></span></code></pre></div><p>对应 <code>user</code> 表的 Java Entity 为 <code>User</code>，其源码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.model</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Data</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Entity</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@Table</span>(name<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;user&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>User</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Id</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@GeneratedValue</span>(strategy<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>GenerationType.<span style=color:teal>IDENTITY</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Long<span style=color:#bbb> </span>id;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>name;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span>email;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Integer<span style=color:#bbb> </span>yearOfBirth;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Date<span style=color:#bbb> </span>createdAt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>Date<span style=color:#bbb> </span>updatedAt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>我们使用的 ORM 框架为 JPA，为了支撑 User 的增删改查操作，需要编写一个 <code>UserRepository</code>。</p><p>可以看到，我们在如下 <code>UserRepository</code> 编写了四个方法，前两个为查询，后两个为更新和删除（分别使用 HQL 和原生 SQL）。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.repository</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>interface</span> <span style=color:#458;font-weight:700>UserRepository</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>extends</span><span style=color:#bbb> </span>CrudRepository<span style=color:#000;font-weight:700>&lt;</span>User,<span style=color:#bbb> </span>Long<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#458;font-weight:700>boolean</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>existsByNameAndEmail</span>(String<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>String<span style=color:#bbb> </span>email);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>List<span style=color:#000;font-weight:700>&lt;</span>User<span style=color:#000;font-weight:700>&gt;</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>findByNameIgnoreCase</span>(String<span style=color:#bbb> </span>name);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Transactional</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Modifying</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Query</span>(<span style=color:#d14>&#34;UPDATE User u SET u.name = :name WHERE u.email = :email&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>updateNameByEmail</span>(<span style=color:#3c5d5d;font-weight:700>@Param</span>(<span style=color:#d14>&#34;name&#34;</span>)<span style=color:#bbb> </span>String<span style=color:#bbb> </span>name,<span style=color:#bbb> </span><span style=color:#3c5d5d;font-weight:700>@Param</span>(<span style=color:#d14>&#34;email&#34;</span>)<span style=color:#bbb> </span>String<span style=color:#bbb> </span>email);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Transactional</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Modifying</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Query</span>(value<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#34;DELETE FROM user WHERE email = :email&#34;</span>,<span style=color:#bbb> </span>nativeQuery<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>true</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>deleteByEmail</span>(<span style=color:#3c5d5d;font-weight:700>@Param</span>(<span style=color:#d14>&#34;email&#34;</span>)<span style=color:#bbb> </span>String<span style=color:#bbb> </span>email);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=23-添加配置>2.3 添加配置</h3><p>下面在 <code>application.yaml</code> 添加数据库连接配置。</p><p>可以看到，我们并未手动将数据库 URL 更改为 <code>jdbc:p6spy:mysql://xxx</code>，也未手动将 Driver Class 更改为 <code>com.p6spy.engine.spy.P6SpyDriver</code>，完全使用的是实际的数据库 URL 和驱动类。这是因为，我们引入的不是原始的 P6Spy 依赖包，而是 P6Spy Spring Boot Starter，该 Starter 内部会使用装饰器帮我们修改数据源，从而省去了手动的修改。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#998;font-style:italic># application.yaml</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>spring</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>datasource</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>url</span>:<span style=color:#bbb> </span>jdbc:mysql://localhost:3306/test?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>username</span>:<span style=color:#bbb> </span>root<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>password</span>:<span style=color:#bbb> </span>root<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>driver-class-name</span>:<span style=color:#bbb> </span>com.mysql.cj.jdbc.Driver<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>jpa</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>show-sql</span>:<span style=color:#bbb> </span><span style=color:#000;font-weight:700>false</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=24-p6spy-初步使用>2.4 P6Spy 初步使用</h3><p>接下来就可以对 P6Spy 进行使用了。下面我们编写一个单元测试类 <code>UserRepositoryTest</code> 来对上述 <code>UserRepository</code> 进行测试。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.repository</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#3c5d5d;font-weight:700>@SpringBootTest</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>UserRepositoryTest</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Autowired</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>private</span><span style=color:#bbb> </span>UserRepository<span style=color:#bbb> </span>userRepository;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Test</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Order</span>(1)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#458;font-weight:700>void</span><span style=color:#bbb> </span><span style=color:#900;font-weight:700>testSave</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>User<span style=color:#bbb> </span>user<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>User();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setName</span>(<span style=color:#d14>&#34;Larry&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setEmail</span>(<span style=color:#d14>&#34;larry@larry.com&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setYearOfBirth</span>(2000);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setCreatedAt</span>(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Date());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>user.<span style=color:teal>setUpdatedAt</span>(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Date());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>userRepository.<span style=color:teal>save</span>(user);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#998;font-style:italic>// ...</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>调用后，发现应用程序日志里多了如下一行输出。可以看到，P6Spy 起作用了，其捕获了最终的 SQL 语句，并打印了该语句执行所花费的时间。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#1756628295717 | took 29ms | statement | connection 2| url jdbc:mysql://localhost:3306/test?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8
</span></span><span style=display:flex><span>insert into user (created_at,email,name,updated_at,year_of_birth) values (?,?,?,?,?)
</span></span><span style=display:flex><span>insert into user (created_at,email,name,updated_at,year_of_birth) values (&#39;2025-08-31T16:18:15.557+0800&#39;,&#39;larry@larry.com&#39;,&#39;Larry&#39;,&#39;2025-08-31T16:18:15.557+0800&#39;,2000);
</span></span></code></pre></div><p>至此，我们可以看到，在 Spring Boot 中使用 P6Spy 非常的简单，只需引入一个 P6Spy Starter 即可，无需做额外配置，P6Spy 即可帮我们捕捉 SQL 并统计其耗时信息。</p><h3 id=25-p6spy-进阶使用>2.5 P6Spy 进阶使用</h3><p><strong>自定义日志输出格式</strong></p><p>从上面的输出可以看到，P6Spy 默认的输出除了打印最终 SQL 外，还打印了 Prepared Statement、数据库 URL 等其它信息。如果我们不想要 P6Spy 打印这些额外的信息，可以手动指定需要打印的信息。</p><p>要想自定义一些 P6Spy 的参数，就需要在工程 <code>resources</code> 目录下新建一个 <code>spy.properties</code>。</p><p>下面的配置在 <code>spy.properties</code> 中指定了自定义的日志输出格式。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#998;font-style:italic># spy.properties</span>
</span></span><span style=display:flex><span><span style=color:teal>logMessageFormat</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>com.p6spy.engine.spy.appender.CustomLineFormat</span>
</span></span><span style=display:flex><span><span style=color:teal>customLogMessageFormat</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>%(currentTime)|%(executionTime)ms|%(category)|%(sqlSingleLine)</span>
</span></span></code></pre></div><p>再次运行 <code>UserRepositoryTest</code> 测试类，发现 P6Spy 的打印信息变了。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>1756628485593|31ms|statement|insert into user (created_at,email,name,updated_at,year_of_birth) values (&#39;2025-08-31T16:21:25.354+0800&#39;,&#39;larry@larry.com&#39;,&#39;Larry&#39;,&#39;2025-08-31T16:21:25.354+0800&#39;,2000)
</span></span></code></pre></div><p><strong>自定义 P6Spy 打印器</strong></p><p>再高级一点的用法是自己编写 P6Spy 的「打印器」，下面尝试编写一个 P6Spy 的「打印器」，除了将时间戳显示更直观以外，还尝试获取并输出 SQL 操作的调用者（Caller）。</p><p>下面的配置即在 <code>spy.properties</code> 指定了自己编写的「打印器」。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#998;font-style:italic># spy.properties</span>
</span></span><span style=display:flex><span><span style=color:teal>logMessageFormat</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>com.example.demo.formatter.CustomP6SpyMessageFormatter</span>
</span></span></code></pre></div><p>该「打印器」的源码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000;font-weight:700>package</span><span style=color:#bbb> </span><span style=color:#555>com.example.demo.formatter</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>CustomP6SpyMessageFormatter</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>implements</span><span style=color:#bbb> </span>MessageFormattingStrategy<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#3c5d5d;font-weight:700>@Override</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#000;font-weight:700>public</span><span style=color:#bbb> </span>String<span style=color:#bbb> </span><span style=color:#900;font-weight:700>formatMessage</span>(<span style=color:#458;font-weight:700>int</span><span style=color:#bbb> </span>connId,<span style=color:#bbb> </span>String<span style=color:#bbb> </span>now,<span style=color:#bbb> </span><span style=color:#458;font-weight:700>long</span><span style=color:#bbb> </span>elapsed,<span style=color:#bbb> </span>String<span style=color:#bbb> </span>category,<span style=color:#bbb> </span>String<span style=color:#bbb> </span>prepared,<span style=color:#bbb> </span>String<span style=color:#bbb> </span>sql,<span style=color:#bbb> </span>String<span style=color:#bbb> </span>url)<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>if</span><span style=color:#bbb> </span>(StringUtils.<span style=color:teal>isBlank</span>(sql))<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:#d14>&#34;&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span>caller<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span>Arrays.<span style=color:teal>stream</span>(Thread.<span style=color:teal>currentThread</span>().<span style=color:teal>getStackTrace</span>())<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>filter</span>(e<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>e.<span style=color:teal>getClassName</span>().<span style=color:teal>startsWith</span>(<span style=color:#d14>&#34;com.example.demo&#34;</span>))<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>filter</span>(e<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>!</span>e.<span style=color:teal>getClassName</span>().<span style=color:teal>equals</span>(CustomP6SpyMessageFormatter.<span style=color:teal>class</span>.<span style=color:teal>getName</span>()))<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>findFirst</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>map</span>(e<span style=color:#bbb> </span><span style=color:#000;font-weight:700>-&gt;</span><span style=color:#bbb> </span>String.<span style=color:teal>format</span>(<span style=color:#d14>&#34;%s#%s:%d&#34;</span>,<span style=color:#bbb> </span>e.<span style=color:teal>getClassName</span>(),<span style=color:#bbb> </span>e.<span style=color:teal>getMethodName</span>(),<span style=color:#bbb> </span>e.<span style=color:teal>getLineNumber</span>()))<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>orElse</span>(<span style=color:#d14>&#34;Unknown&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>String<span style=color:#bbb> </span>nowFormatted<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>SimpleDateFormat(<span style=color:#d14>&#34;yyyy-MM-dd HH:mm:ss.SSS&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>.<span style=color:teal>format</span>(<span style=color:#000;font-weight:700>new</span><span style=color:#bbb> </span>Date(Long.<span style=color:teal>parseLong</span>(now)));<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#000;font-weight:700>return</span><span style=color:#bbb> </span>String.<span style=color:teal>format</span>(<span style=color:#d14>&#34;%s - [Time elapsed: %d ms] [Caller: %s] [SQL: %s]&#34;</span>,<span style=color:#bbb> </span>nowFormatted,<span style=color:#bbb> </span>elapsed,<span style=color:#bbb> </span>caller,<span style=color:#bbb> </span>sql.<span style=color:teal>trim</span>());<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>可以看到，该自定义「打印器」实现了 P6Spy 的 <code>MessageFormattingStrategy</code> 接口并重写了其 <code>formatMessage()</code> 方法。然后，在该方法内，按照我们的想法，找出了调用者并格式化了 SQL 抓取时间。</p><p>重新运行 <code>UserRepositoryTest</code> 测试类，发现 P6Spy 打印的日志信息变为了我们所自定义的。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>2025-08-31 16:25:09.685 - [Time elapsed: 31 ms] [Caller: com.example.demo.repository.UserRepositoryTest#testSave:27] [SQL: insert into user (created_at,email,name,updated_at,year_of_birth) values (&#39;2025-08-31T16:25:09.483+0800&#39;,&#39;larry@larry.com&#39;,&#39;Larry&#39;,&#39;2025-08-31T16:25:09.483+0800&#39;,2000)]
</span></span></code></pre></div><p><strong>将 P6Spy 日志与应用程序日志分离</strong></p><p>P6Spy 默认使用的 Log Appender 是 <code>com.p6spy.engine.spy.appender.Slf4JLogger</code>。所以，P6Spy 的日志默认是输出到我们应用程序的总日志中的。</p><p>实际项目中，使用 P6Spy 时为了更好的观察 SQL 的运行情况，通常需要将 P6Spy 的日志单独打印到一个文件，并进行单独管理。</p><p>下面即尝试修改我们示例工程的日志管理文件 <code>logback.xml</code>，将 P6Spy 的日志单独输出到一个文件 <code>p6spy.log</code>，并进行存档和定期清理。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#998;font-style:italic>&lt;!-- logback.xml --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#999;font-weight:700;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;appender</span> <span style=color:teal>name=</span><span style=color:#d14>&#34;P6SPY_FILE&#34;</span> <span style=color:teal>class=</span><span style=color:#d14>&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style=color:navy>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;file&gt;</span>${LOG_HOME}/p6spy.log<span style=color:navy>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;encoder&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;pattern&gt;</span>%msg%n<span style=color:navy>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;charset&gt;</span>UTF-8<span style=color:navy>&lt;/charset&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;/encoder&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;rollingPolicy</span> <span style=color:teal>class=</span><span style=color:#d14>&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style=color:navy>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;fileNamePattern&gt;</span>${LOG_HOME}/p6spy.%d{yyyy-MM-dd}.%i.log.gz<span style=color:navy>&lt;/fileNamePattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;maxFileSize&gt;</span>100MB<span style=color:navy>&lt;/maxFileSize&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;maxHistory&gt;</span>7<span style=color:navy>&lt;/maxHistory&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:navy>&lt;totalSizeCap&gt;</span>2GB<span style=color:navy>&lt;/totalSizeCap&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;/rollingPolicy&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/appender&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;logger</span> <span style=color:teal>name=</span><span style=color:#d14>&#34;p6spy&#34;</span> <span style=color:teal>level=</span><span style=color:#d14>&#34;INFO&#34;</span> <span style=color:teal>additivity=</span><span style=color:#d14>&#34;false&#34;</span><span style=color:navy>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;appender-ref</span> <span style=color:teal>ref=</span><span style=color:#d14>&#34;P6SPY_FILE&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:navy>&lt;appender-ref</span> <span style=color:teal>ref=</span><span style=color:#d14>&#34;CONSOLE&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;/logger&gt;</span>
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span><span style=color:navy>&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>这样，P6Spy 的日志即会与应用程序总日志分离，而单独输出到 <code>p6spy.log</code>，而且历史日志也会按要求清理或存档。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>p6spy.log
</span></span><span style=display:flex><span>p6spy.2025-08-30.0.log.gz
</span></span></code></pre></div><h2 id=3-小结>3 小结</h2><p>综上，我们首先介绍了 P6Spy 的功能、使用场景和工作原理，然后在 Spring Boot 示例工程中引入了 P6Spy Starter，对 P6Spy 基础功能和进阶功能的使用进行了演示。示例工程完整代码已提交至 <a href=https://github.com/leileiluoluo/java-exercises/blob/main/spring-boot-p6spy-demo>GitHub</a>，供有需要的同学参考。</p><blockquote><p>参考资料</p><p>[1] P6Spy: Documentation - <a href=https://p6spy.readthedocs.io/en/latest/>https://p6spy.readthedocs.io/en/latest/</a></p><p>[2] GitHub: Spring Boot integration with p6spy - <a href=https://github.com/gavlyukovskiy/spring-boot-data-source-decorator>https://github.com/gavlyukovskiy/spring-boot-data-source-decorator</a></p></blockquote></div><div class=content-footer><div class=weixinhao><img src=/static/images/self/weixinhao-white.jpg></div><div class=post-tags><a href=/tags/java/>#Java</a>
<a href=/tags/spring/>#Spring</a></div><div class=license><i class=ti-info-alt></i><div class=info>版权声明：该博客文章由作者通过「<a href=https://creativecommons.org/licenses/by/4.0/deed.zh>知识共享署名 4.0 许可证</a>」进行授权，转载须注明文章原始链接。</div></div></div></div><div class="col-lg-8 mx-auto block shadow"><h3>相关文章</h3><ul><li><a href=/posts/how-to-use-spring-event.html>如何使用 Spring Event 实现内部模块间的轻松解耦？</a></li><li><a href=/posts/how-to-capture-entity-operations-in-spring-data-jpa.html>使用 Spring Data JPA 时如何捕捉实体的增删改操作？</a></li><li><a href=/posts/how-to-write-a-service-factory-in-spring-boot.html>在 Spring Boot 中如何优雅的编写一个服务工厂？</a></li><li><a href=/posts/spring-data-neo4j-database-config-error.html>Spring Data Neo4j 指定 spring.data.neo4j.database 时报错该如何解决？</a></li><li><a href=/posts/how-does-spring-data-operate-both-mysql-and-neo4j.html>如何使用 Spring Data 同时访问 MySQL 和 Neo4j 数据库？</a></li></ul></div><div class="col-lg-8 mx-auto block shadow"><div><h3>评论</h3><div id=comment-loading style=text-align:center;font-size:14px><img style=width:52px src=/static/images/site/mona-loading-default.gif>
<span>正在加载评论......</span></div><script>function handleMessage(e){if(e.origin!=="https://giscus.app")return;if(typeof e.data!="object"||!e.data.giscus)return;const t=document.getElementById("comment-loading");t.style.display="none"}window.addEventListener("message",handleMessage)</script><script src=https://giscus.app/client.js data-repo=leileiluoluo/leileiluoluo.github.io data-repo-id=R_kgDOJkLT8w data-category=General data-category-id=DIC_kwDOJkLT884CdtEh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></div></div></div></section><footer class="py-4 bg-lights border-top"><div class=container><div class="row justify-content-between text-center align-items-center"><div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0"></div><div class="col-lg-4 text-center mb-4 mb-lg-0"><ul class="list-inline mb-0"><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/sponsor>随喜打赏</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/about>关于本博</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/links>友情链接</a></li></ul></div><div class="col-lg-4 text-lg-right text-center mb-4 mb-lg-0"><ul class="list-inline social-icon mb-0"><li class=list-inline-item><a title=文章归档 href=/archives/><i class=ti-archive></i></a></li><li class=list-inline-item><a title=文章标签 href=/tags/><i class=ti-tag></i></a></li><li class=list-inline-item><a title="我的 GitHub" href=https://github.com/leileiluoluo><i class=ti-github></i></a></li><li class=list-inline-item><a title="网站 RSS" href=/index.xml><i class=ti-rss></i></a></li></ul></div></div><div style=text-align:center;margin-bottom:22px><a href=https://www.boyouquan.com/planet-shuttle target=_blank><img width=90px height=28px src=https://boyouquan.com/assets/images/sites/logo/planet-shuttle.svg></a></div><div class="text-center mt-4"><span>Made with <a href=https://gohugo.io/>Hugo</a> | Theme by <a href=https://github.com/themefisher/northendlab-hugo>NorthendLab</a> | <a href=https://beian.miit.gov.cn>辽ICP备2022012085号-5</a> | Copyright © 2017-2026 | <a href=https://www.boyouquan.com/certificates/leileiluoluo.com title=正在博友圈履约中 target=_blank><img style=height:20px src="https://www.boyouquan.com/images/logo/performance.svg?domainName=leileiluoluo.com" alt=正在博友圈履约中></a></span></div></div></footer><script>var indexURL="https://leileiluoluo.github.io/index.json"</script><script src=https://leileiluoluo.github.io/js/jquery.min.js></script><script src=https://leileiluoluo.github.io/js/bootstrap.min.js></script><script src=https://leileiluoluo.github.io/js/fuse.min.js></script><script src=https://leileiluoluo.github.io/js/mark.js></script><script src=https://leileiluoluo.github.io/js/search.js></script><script src=https://leileiluoluo.github.io/js/script.min.js></script></body></html>