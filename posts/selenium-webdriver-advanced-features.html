<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>Selenium WebDriver 高级特性使用 - 磊磊落落</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="自动化测试,Selenium,WebDriver,高级特性,使用总结,Python,Chrome"><meta name=description content="本文以 Python 代码示例的方式介绍了 Selenium WebDriver 高级特性的使用，涉及页面加载策略、等待策略、元素定位与操作、浏览器操作。"><meta name=author content="磊磊落落"><meta name=generator content="Hugo 0.123.7"><link rel=stylesheet href=https://leileiluoluo.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/themify-icons.css><link rel=stylesheet href=https://leileiluoluo.github.io/css/larry-custom-v1.6.css><link rel=stylesheet href=https://leileiluoluo.github.io/scss/style.min.css media=screen><link rel="shortcut icon" href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><link rel=icon href=https://leileiluoluo.github.io/images/favicon.png type=image/x-icon><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?526723b767317055572c85bdb445353c",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><header class="fixed-top navigation"><div class=container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><a class=navbar-brand href=https://leileiluoluo.github.io/>磊磊落落</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/></a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/>计算机</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E9%9A%8F%E7%AC%94/>随笔</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%AF%BB%E4%B9%A6/>读书</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E8%A7%82%E5%BD%B1/>观影</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/categories/%E7%BB%83%E5%AD%97/>练字</a></li><li class=nav-item><a class=nav-link href=https://leileiluoluo.github.io/about>关于</a></li></ul><div class=search><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://leileiluoluo.github.io//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder=键入关键字后回车...></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><div class="py-5 d-none d-lg-block"></div><section class=section><div class=container><div class=row><div class="col-lg-8 mx-auto block shadow mb-5"><h1>Selenium WebDriver 高级特性使用</h1><div class="mb-3 post-meta">2023年04月24日
<a href=/categories/%e8%ae%a1%e7%ae%97%e6%9c%ba>计算机</a></div><div class="content mb-5"><p>上文「<a href=https://leileiluoluo.github.io/posts/selenium-webdriver.html>Selenium WebDriver 基础使用</a>」介绍了 Selenium WebDriver 基础功能的使用；本文将接着介绍 Selenium WebDriver 高级特性的使用，涉及页面加载策略、等待策略、元素定位与操作、浏览器操作。</p><p>本文涉及的所有示例程序均使用 Python 语言描述。此外，下面还列出了本文所使用的浏览器和 Selenium 版本信息。</p><ul><li>浏览器：Chrome</li><li>Selenium 版本：4.9.0</li></ul><h2 id=1-页面加载策略>1 页面加载策略</h2><p>Selenium WebDriver 的浏览器选项有三种页面加载策略可供选择，它们是：<code>normal</code>、<code>eager</code>和<code>none</code>。</p><p>了解它们代表什么之前，先介绍一下加载及渲染一个 Web 页面大概有哪些阶段。</p><p>按事件分的话，一个网页的生命周期主要有<code>DOMContentLoaded</code>、<code>load</code>、<code>beforeunload</code>和<code>unload</code>这几个阶段。</p><ul><li><p><code>DOMContentLoaded</code></p><p>HTML 文档已加载完成，DOM 树已构建完成，但依赖的脚本、图片、样式表、iFrame 等外部资源可能还没有加载完成。</p></li><li><p><code>load</code></p><p>不仅 HTML 文档已加载完成，依赖的脚本、图片、样式表、iFrame 等外部资源均已加载完成。</p></li><li><p><code>beforeunload</code></p><p>用户离开前的前置事件。</p></li><li><p><code>unload</code></p><p>用户已经离开。</p></li></ul><p>按<code>document.readyState</code>分的话，只有<code>loading</code>、<code>interactive</code>和<code>complete</code>这三个阶段。</p><ul><li><p><code>loading</code></p><p>HTML 文档仍在加载。</p></li><li><p><code>interactive</code></p><p>HTML 文档已加载并解析完成，但依赖的脚本、图片、样式表、iFrame 等外部资源可能还没有加载完成。</p></li><li><p><code>complete</code></p><p>HTML 文档以及依赖的脚本、图片、样式表、iFrame 等外部资源均已加载完成。</p></li></ul><p>下图将这两种方式组合到一起来看一下一个网页的生命周期：</p><p><img loading=lazy src=https://leileiluoluo.github.io/static/images/uploads/2023/04/web-page-lifecycle.svg#center alt=网页生命周期></p><p>可以看到，事件里的<code>DOMContentLoaded</code>对应<code>document.readyState</code>里的<code>interactive</code>；事件里的<code>load</code>对应<code>document.readyState</code>里的<code>complete</code>。</p><p>而 Selenium WebDriver 支持的三种加载策略与事件和<code>document.readyState</code>的对应关系如下表所示：</p><table><thead><tr><th>Selenium 页面加载策略</th><th>对应的事件</th><th>对应的<code>document.readyState</code></th></tr></thead><tbody><tr><td><code>normal</code>（默认值）</td><td><code>load</code></td><td><code>complete</code></td></tr><tr><td><code>eager</code></td><td><code>DOMContentLoaded</code></td><td><code>interactive</code></td></tr><tr><td><code>none</code></td><td>无</td><td>Any（任何状态都可以）</td></tr></tbody></table><p>可以看到，当访问一个 URL 时，Selenium WebDriver 的默认策略是等待整个页面全部加载完成（除了使用<code>JavaScript</code>在<code>load</code>事件后再动态添加内容）。在编写自动化测试用例时，如果测试逻辑不依赖外部资源的加载，即可以将页面加载策略从默认选项<code>normal</code>改为<code>eager</code>或<code>none</code>来加速测试过程。</p><p>更改 Selenium WebDriver 页面加载策略的示例 Python 代码（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/page_load_strategy.py>page_load_strategy.py</a>）如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium</span> <span style=color:#000;font-weight:700>import</span> webdriver
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.chrome.options</span> <span style=color:#000;font-weight:700>import</span> Options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options <span style=color:#000;font-weight:700>=</span> Options()
</span></span><span style=display:flex><span>options<span style=color:#000;font-weight:700>.</span>page_load_strategy <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#39;eager&#39;</span>  <span style=color:#998;font-style:italic># &#39;none&#39;, &#39;normal&#39;</span>
</span></span><span style=display:flex><span>driver <span style=color:#000;font-weight:700>=</span> webdriver<span style=color:#000;font-weight:700>.</span>Chrome(options<span style=color:#000;font-weight:700>=</span>options)
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;http://www.baidu.com&#39;</span>)
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>quit()
</span></span></code></pre></div><h2 id=2-等待策略>2 等待策略</h2><p>通俗点讲，WebDriver 是一个告诉浏览器做什么的库。因 Web 页面具有一定的异步特性，且 WebDriver 不会实时跟踪 DOM 的状态；所以，有些情况下，定位元素时，可能会出现「no such element」错误。</p><p>下面看一段代码（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/no_such_element.py>no_such_element.py</a>）：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium</span> <span style=color:#000;font-weight:700>import</span> webdriver
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver</span> <span style=color:#000;font-weight:700>import</span> Keys
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.common.by</span> <span style=color:#000;font-weight:700>import</span> By
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver <span style=color:#000;font-weight:700>=</span> webdriver<span style=color:#000;font-weight:700>.</span>Chrome()
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;https://www.baidu.com/&#39;</span>)
</span></span><span style=display:flex><span>text_input <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;kw&#39;</span>)
</span></span><span style=display:flex><span>text_input<span style=color:#000;font-weight:700>.</span>send_keys(<span style=color:#d14>&#39;Selenium&#39;</span> <span style=color:#000;font-weight:700>+</span> Keys<span style=color:#000;font-weight:700>.</span>RETURN)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 会抛出 NoSuchElementException</span>
</span></span><span style=display:flex><span>first_result_title <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>XPATH, <span style=color:#d14>&#39;//div[@id=&#34;content_left&#34;]/div[1]/h3&#39;</span>)<span style=color:#000;font-weight:700>.</span>text
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(first_result_title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>quit()
</span></span></code></pre></div><p>这段代码打开了百度首页，然后键入关键字<code>Selenium</code>后回车进行搜索，接着即找第一个结果的标题进行打印。运行该代码时，会抛出<code>NoSuchElementException</code>，原因是定位元素的时候，搜索结果页面还没有完全打开，因此未找到对应的元素。</p><p>遇到这样的问题怎么办呢？可以通过 Selenium WebDriver 提供的显式等待或隐式等待功能来解决。</p><h3 id=21-显式等待>2.1 显式等待</h3><p>显式等待，即程序暂停执行直至传递的条件满足。显式等待非常适合被用来做 WebDriver 与 DOM 的状态同步。</p><p>上面抛出「no such element」错误的代码（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/no_such_element.py>no_such_element.py</a>）可使用显式等待的方式改造为（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/explicit_wait.py>explicit_wait.py</a>）：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium</span> <span style=color:#000;font-weight:700>import</span> webdriver
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver</span> <span style=color:#000;font-weight:700>import</span> Keys
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.common.by</span> <span style=color:#000;font-weight:700>import</span> By
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.support.wait</span> <span style=color:#000;font-weight:700>import</span> WebDriverWait
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.support</span> <span style=color:#000;font-weight:700>import</span> expected_conditions <span style=color:#000;font-weight:700>as</span> EC
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver <span style=color:#000;font-weight:700>=</span> webdriver<span style=color:#000;font-weight:700>.</span>Chrome()
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;https://www.baidu.com/&#39;</span>)
</span></span><span style=display:flex><span>text_input <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;kw&#39;</span>)
</span></span><span style=display:flex><span>text_input<span style=color:#000;font-weight:700>.</span>send_keys(<span style=color:#d14>&#39;Selenium&#39;</span> <span style=color:#000;font-weight:700>+</span> Keys<span style=color:#000;font-weight:700>.</span>RETURN)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 等待搜索结果展示</span>
</span></span><span style=display:flex><span>WebDriverWait(driver, <span style=color:#099>10</span>)<span style=color:#000;font-weight:700>.</span>until(EC<span style=color:#000;font-weight:700>.</span>presence_of_element_located((By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;content_left&#39;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 不会抛出异常</span>
</span></span><span style=display:flex><span>first_result_title <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>XPATH, <span style=color:#d14>&#39;//div[@id=&#34;content_left&#34;]/div[1]/h3&#39;</span>)<span style=color:#000;font-weight:700>.</span>text
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(first_result_title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>quit()
</span></span></code></pre></div><p>可以看到，我们新建了一个<code>WebDriverWait</code>对象（指定了超时时间），并使用<code>expected_conditions.presence_of_element_located()</code>方法为其设置了跳出条件。除此方法外，<code>expected_conditions</code>包下常用的方法还有<code>expected_conditions.url_contains()</code>与<code>expected_conditions.title_is()</code>等。</p><h3 id=22-隐式等待>2.2 隐式等待</h3><p>隐式等待是告诉 WebDriver 在查找元素时，若不存在，即轮询 DOM 一段时间。其一般在新建 WebDriver 时设置，对整个会话有效。</p><p>上面抛出「no such element」错误的代码（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/no_such_element.py>no_such_element.py</a>）可使用隐式等待的方式改造为（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/implicit_wait.py>implicit_wait.py</a>）：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium</span> <span style=color:#000;font-weight:700>import</span> webdriver
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver</span> <span style=color:#000;font-weight:700>import</span> Keys
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.common.by</span> <span style=color:#000;font-weight:700>import</span> By
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver <span style=color:#000;font-weight:700>=</span> webdriver<span style=color:#000;font-weight:700>.</span>Chrome()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 设置隐式等待时间</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>implicitly_wait(<span style=color:#099>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;https://www.baidu.com/&#39;</span>)
</span></span><span style=display:flex><span>text_input <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;kw&#39;</span>)
</span></span><span style=display:flex><span>text_input<span style=color:#000;font-weight:700>.</span>send_keys(<span style=color:#d14>&#39;Selenium&#39;</span> <span style=color:#000;font-weight:700>+</span> Keys<span style=color:#000;font-weight:700>.</span>RETURN)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 不会抛出异常</span>
</span></span><span style=display:flex><span>first_result_title <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>XPATH, <span style=color:#d14>&#39;//div[@id=&#34;content_left&#34;]/div[1]/h3&#39;</span>)<span style=color:#000;font-weight:700>.</span>text
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(first_result_title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>quit()
</span></span></code></pre></div><p>真实的测试场景，一般只建议使用显式等待。</p><h2 id=3-元素定位与操作>3 元素定位与操作</h2><p>定位与操作 DOM 中的元素是使用 Selenium 编写自动化测试用例的主要工作。</p><h3 id=31-元素定位>3.1 元素定位</h3><p>Selenium WebDriver 提供 8 种基本的元素定位方法。</p><table><thead><tr><th>定位方法</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>查找 id 属性与搜索值匹配的元素</td></tr><tr><td>name</td><td>查找 name 属性与搜索值匹配的元素</td></tr><tr><td>class name</td><td>查找 class 名包含搜索值的元素</td></tr><tr><td>css selector</td><td>查找与 CSS 选择器匹配的元素</td></tr><tr><td>link text</td><td>查找其可见文本与搜索值匹配的锚元素</td></tr><tr><td>partial link text</td><td>查找其可见文本包含搜索值的锚元素。如有多个，则仅选择第一个元素。</td></tr><tr><td>tag name</td><td>查找 tag 名与搜索值匹配的元素</td></tr><tr><td>xpath</td><td>查找与 XPath 表达式匹配的元素</td></tr></tbody></table><p>如下为百度搜索框 input 标签的 HTML 代码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:navy>input</span> <span style=color:teal>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;kw&#34;</span> <span style=color:teal>name</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;wd&#34;</span> <span style=color:teal>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;s_ipt&#34;</span> <span style=color:teal>maxlength</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;255&#34;</span> <span style=color:teal>autocomplete</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;off&#34;</span> /&gt;
</span></span></code></pre></div><p>可使用如下几种方式来定位到该 input 元素：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;kw&#39;</span>)
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>CLASS_NAME, <span style=color:#d14>&#39;s_ipt&#39;</span>)
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>NAME, <span style=color:#d14>&#39;wd&#39;</span>)
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>XPATH, <span style=color:#d14>&#39;//input[@name=&#34;wd&#34;]&#39;</span>)
</span></span></code></pre></div><p>此外，Selenium 在版本 4 引入了相对定位器，即可使用空间相对位置来定位一个元素，其可在传统定位器无法描述时使用。</p><p>如下为 Selenium 官网提供的一个「<a href=https://www.selenium.dev/selenium/web/web-form.html>Web 表单示例页面</a>」：</p><p><img loading=lazy src=https://leileiluoluo.github.io/static/images/uploads/2023/04/selenium-web-form.jpeg#center alt="Selenium Web 表单示例页面"></p><p>可以看到，在该页面左侧部分<code>Text input</code>输入框下有一个<code>Password</code>输入框。</p><p>这两个输入框的 HTML 代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:navy>input</span> <span style=color:teal>type</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;text&#34;</span> <span style=color:teal>name</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;my-text&#34;</span> <span style=color:teal>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;my-text-id&#34;</span> /&gt;
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>&lt;<span style=color:navy>input</span> <span style=color:teal>type</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;password&#34;</span> <span style=color:teal>name</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;my-password&#34;</span> <span style=color:teal>autocomplete</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;off&#34;</span> /&gt;
</span></span></code></pre></div><p>若<code>Password</code>输入框采用传统方法不好定位，则可使用相对定位器来定位：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>password_locator <span style=color:#000;font-weight:700>=</span> locate_with(By<span style=color:#000;font-weight:700>.</span>TAG_NAME, <span style=color:#d14>&#39;input&#39;</span>)<span style=color:#000;font-weight:700>.</span>below({By<span style=color:#000;font-weight:700>.</span>ID: <span style=color:#d14>&#39;my-text-id&#39;</span>})
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>find_element(password_locator)
</span></span></code></pre></div><h3 id=32-元素操作>3.2 元素操作</h3><p>Selenium 提供 4 个基本的元素操作命令。它们是：</p><ul><li>Click</li><li>Send Keys</li><li>Clear</li><li>Select</li></ul><p>下面使用一个例子来演示如何使用这几个命令。</p><p>如下为百度关键字输入框和「百度一下」搜索按钮的 HTML 代码：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:navy>input</span> <span style=color:teal>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;kw&#34;</span> <span style=color:teal>name</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;wd&#34;</span> <span style=color:teal>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;s_ipt&#34;</span> <span style=color:teal>maxlength</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;255&#34;</span> <span style=color:teal>autocomplete</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;off&#34;</span> /&gt;
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>&lt;<span style=color:navy>input</span> <span style=color:teal>type</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;submit&#34;</span> <span style=color:teal>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;su&#34;</span> <span style=color:teal>value</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;百度一下&#34;</span> <span style=color:teal>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;bg s_btn&#34;</span> /&gt;
</span></span></code></pre></div><p>可使用如下命令进行关键字清除、键入关键字和点击搜索按钮操作：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>input_text <span style=color:#000;font-weight:700>=</span> driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;kw&#39;</span>)
</span></span><span style=display:flex><span>input_text<span style=color:#000;font-weight:700>.</span>clear()
</span></span><span style=display:flex><span>input_text<span style=color:#000;font-weight:700>.</span>send_keys(<span style=color:#d14>&#39;Selenium&#39;</span>)
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;su&#39;</span>)<span style=color:#000;font-weight:700>.</span>click()
</span></span></code></pre></div><p>关于 Select 命令的使用，同样使用 Selenium 官网的「<a href=https://www.selenium.dev/selenium/web/web-form.html>Web 表单示例页面</a>」作示例。</p><p>该页面上的<code>Dropdown (select)</code>是一个单选框，其 HTML 代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:navy>select</span> <span style=color:teal>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;form-select&#34;</span> <span style=color:teal>name</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;my-select&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>option</span> <span style=color:teal>selected</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;&#34;</span>&gt;Open this select menu&lt;/<span style=color:navy>option</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>option</span> <span style=color:teal>value</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;1&#34;</span>&gt;One&lt;/<span style=color:navy>option</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>option</span> <span style=color:teal>value</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;2&#34;</span>&gt;Two&lt;/<span style=color:navy>option</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>option</span> <span style=color:teal>value</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;3&#34;</span>&gt;Three&lt;/<span style=color:navy>option</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:navy>select</span>&gt;
</span></span></code></pre></div><p>使用<code>Select</code>对象选择下拉选项的 Python 代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>dropdown <span style=color:#000;font-weight:700>=</span> Select(driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>NAME, <span style=color:#d14>&#39;my-select&#39;</span>))
</span></span><span style=display:flex><span>dropdown<span style=color:#000;font-weight:700>.</span>select_by_value(<span style=color:#d14>&#39;2&#39;</span>)
</span></span></code></pre></div><h2 id=4-浏览器操作>4 浏览器操作</h2><h3 id=41-导航操作>4.1 导航操作</h3><p>进行浏览器导航操作的 Python 代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#998;font-style:italic># 打开网址</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;https://selenium.dev&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 点击向后按钮</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>back()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 点击向前按钮</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>forward()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 点击刷新按钮</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>refresh()
</span></span></code></pre></div><h3 id=42-原生弹窗操作>4.2 原生弹窗操作</h3><p>可使用 Selenium WebDriver 来与三种原生的消息弹窗（Alert、Confirm 和 Prompt）交互。</p><p>下面，先看一下用于演示这三种弹窗的 HTML 代码（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/alerts-test.html>alerts-test.html</a>）：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#999;font-weight:700;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:navy>html</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>title</span>&gt;Alerts, Prompts and Confirmations test&lt;/<span style=color:navy>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>script</span>&gt;
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>function</span> exampleAlert() {
</span></span><span style=display:flex><span>        alert(<span style=color:#d14>&#34;This is an example alert&#34;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>function</span> exampleConfirm() {
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>let</span> confirmed <span style=color:#000;font-weight:700>=</span> confirm(<span style=color:#d14>&#34;Do you want to confirm?&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#0086b3>document</span>.getElementById(<span style=color:#d14>&#34;confirmed&#34;</span>).innerText <span style=color:#000;font-weight:700>=</span> confirmed;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>function</span> examplePrompt() {
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>let</span> favoriteSport <span style=color:#000;font-weight:700>=</span> prompt(
</span></span><span style=display:flex><span>          <span style=color:#d14>&#34;What is your favorite sport?&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#d14>&#34;Basketball&#34;</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        <span style=color:#0086b3>document</span>.getElementById(<span style=color:#d14>&#34;favorite-sport&#34;</span>).innerText <span style=color:#000;font-weight:700>=</span> favoriteSport;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    &lt;/<span style=color:navy>script</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:navy>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>table</span> <span style=color:teal>border</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;1&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:navy>tr</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:navy>td</span>&gt;&lt;<span style=color:navy>a</span> <span style=color:teal>onclick</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;exampleAlert()&#34;</span>&gt;Click to see an example alert&lt;/<span style=color:navy>a</span>&gt;&lt;/<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:navy>td</span>&gt;&lt;/<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:navy>tr</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:navy>tr</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:navy>a</span> <span style=color:teal>onclick</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;exampleConfirm()&#34;</span>&gt;Click to see an example confirm&lt;/<span style=color:navy>a</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:navy>td</span>&gt;&lt;<span style=color:navy>p</span> <span style=color:teal>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;confirmed&#34;</span>&gt;&lt;/<span style=color:navy>p</span>&gt;&lt;/<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:navy>tr</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:navy>tr</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:navy>td</span>&gt;&lt;<span style=color:navy>a</span> <span style=color:teal>onclick</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;examplePrompt()&#34;</span>&gt;Click to see an example prompt&lt;/<span style=color:navy>a</span>&gt;&lt;/<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:navy>td</span>&gt;&lt;<span style=color:navy>p</span> <span style=color:teal>id</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;favorite-sport&#34;</span>&gt;&lt;/<span style=color:navy>p</span>&gt;&lt;/<span style=color:navy>td</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:navy>tr</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:navy>table</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:navy>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:navy>html</span>&gt;
</span></span></code></pre></div><p>接着，看一下测试如上 HTML 页面三种弹窗的 Python 代码（<a href=https://github.com/leileiluoluo/python-exercises/blob/main/selenium-advanced-features/alerts_test.py>alerts_test.py</a>）：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>unittest</span> <span style=color:#000;font-weight:700>import</span> TestCase
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium</span> <span style=color:#000;font-weight:700>import</span> webdriver
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.common.by</span> <span style=color:#000;font-weight:700>import</span> By
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.support.wait</span> <span style=color:#000;font-weight:700>import</span> WebDriverWait
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium.webdriver.support</span> <span style=color:#000;font-weight:700>import</span> expected_conditions <span style=color:#000;font-weight:700>as</span> EC
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>TestAlerts</span>(TestCase):
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>setUp</span>(<span style=color:#999>self</span>) <span style=color:#000;font-weight:700>-&gt;</span> <span style=color:#000;font-weight:700>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver <span style=color:#000;font-weight:700>=</span> webdriver<span style=color:#000;font-weight:700>.</span>Chrome()
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>addCleanup(<span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>quit)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>test_alert</span>(<span style=color:#999>self</span>) <span style=color:#000;font-weight:700>-&gt;</span> <span style=color:#000;font-weight:700>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 打开 Alerts 示例页面</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;file:///Users/larry/Desktop/alerts-test.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 点击超链接 &#34;Click to see an example alert&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>LINK_TEXT, <span style=color:#d14>&#39;Click to see an example alert&#39;</span>)<span style=color:#000;font-weight:700>.</span>click()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 等待窗口弹出，获取 Alert 信息，点击 OK</span>
</span></span><span style=display:flex><span>        alert <span style=color:#000;font-weight:700>=</span> WebDriverWait(<span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver, <span style=color:#099>10</span>)<span style=color:#000;font-weight:700>.</span>until(EC<span style=color:#000;font-weight:700>.</span>alert_is_present())
</span></span><span style=display:flex><span>        alert_message <span style=color:#000;font-weight:700>=</span> alert<span style=color:#000;font-weight:700>.</span>text
</span></span><span style=display:flex><span>        alert<span style=color:#000;font-weight:700>.</span>accept()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 断言</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>assertEqual(alert_message, <span style=color:#d14>&#39;This is an example alert&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>test_confirm</span>(<span style=color:#999>self</span>) <span style=color:#000;font-weight:700>-&gt;</span> <span style=color:#000;font-weight:700>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 打开 Alerts 示例页面</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;file:///Users/larry/Desktop/alerts-test.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 点击超链接 &#34;Click to see an example confirm&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>LINK_TEXT, <span style=color:#d14>&#39;Click to see an example confirm&#39;</span>)<span style=color:#000;font-weight:700>.</span>click()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 等待窗口弹出，点击 OK</span>
</span></span><span style=display:flex><span>        alert <span style=color:#000;font-weight:700>=</span> WebDriverWait(<span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver, <span style=color:#099>10</span>)<span style=color:#000;font-weight:700>.</span>until(EC<span style=color:#000;font-weight:700>.</span>alert_is_present())
</span></span><span style=display:flex><span>        alert<span style=color:#000;font-weight:700>.</span>accept()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 获取 `#confirmed` 文本</span>
</span></span><span style=display:flex><span>        confirmed <span style=color:#000;font-weight:700>=</span> <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;confirmed&#39;</span>)<span style=color:#000;font-weight:700>.</span>text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 断言</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>assertEqual(confirmed, <span style=color:#d14>&#39;true&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>test_prompt</span>(<span style=color:#999>self</span>) <span style=color:#000;font-weight:700>-&gt;</span> <span style=color:#000;font-weight:700>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 打开 Alerts 示例页面</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;file:///Users/larry/Desktop/alerts-test.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 点击超链接 &#34;Click to see an example prompt&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>LINK_TEXT, <span style=color:#d14>&#39;Click to see an example prompt&#39;</span>)<span style=color:#000;font-weight:700>.</span>click()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 等待窗口弹出，输入信息，点击 OK</span>
</span></span><span style=display:flex><span>        alert <span style=color:#000;font-weight:700>=</span> WebDriverWait(<span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver, <span style=color:#099>10</span>)<span style=color:#000;font-weight:700>.</span>until(EC<span style=color:#000;font-weight:700>.</span>alert_is_present())
</span></span><span style=display:flex><span>        alert<span style=color:#000;font-weight:700>.</span>send_keys(<span style=color:#d14>&#39;Football&#39;</span>)
</span></span><span style=display:flex><span>        alert<span style=color:#000;font-weight:700>.</span>accept()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 获取 `#favorite-sport` 文本</span>
</span></span><span style=display:flex><span>        favorite_sport <span style=color:#000;font-weight:700>=</span> <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>driver<span style=color:#000;font-weight:700>.</span>find_element(By<span style=color:#000;font-weight:700>.</span>ID, <span style=color:#d14>&#39;favorite-sport&#39;</span>)<span style=color:#000;font-weight:700>.</span>text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># 断言</span>
</span></span><span style=display:flex><span>        <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>assertEqual(favorite_sport, <span style=color:#d14>&#39;Football&#39;</span>)
</span></span></code></pre></div><h3 id=43-cookie-操作>4.3 Cookie 操作</h3><p>可使用 Selenium WebDriver 来操作 Cookie。</p><p>查询、添加和删除 Cookie 的示例 Python 代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>selenium</span> <span style=color:#000;font-weight:700>import</span> webdriver
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver <span style=color:#000;font-weight:700>=</span> webdriver<span style=color:#000;font-weight:700>.</span>Chrome()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 打开 URL</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>get(<span style=color:#d14>&#39;https://www.baidu.com&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 将 Cookie 添加到当前浏览器</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>add_cookie({<span style=color:#d14>&#39;name&#39;</span>: <span style=color:#d14>&#39;foo&#39;</span>, <span style=color:#d14>&#39;value&#39;</span>: <span style=color:#d14>&#39;bar&#39;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 获取所有的 Cookie</span>
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(driver<span style=color:#000;font-weight:700>.</span>get_cookies())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 获取名为 foo 的 Cookie 信息</span>
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(driver<span style=color:#000;font-weight:700>.</span>get_cookie(<span style=color:#d14>&#39;foo&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 删除名为 foo 的 Cookie 信息</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>delete_cookie(<span style=color:#d14>&#39;foo&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 删除所有的 Cookie</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>delete_all_cookies()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>quit()
</span></span></code></pre></div><h3 id=44-窗口与选项卡操作>4.4 窗口与选项卡操作</h3><p>可使用 Selenium WebDriver 来打开、关闭和切换窗口或选项卡。</p><p>操作窗口或选项卡的示例 Python 代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#998;font-style:italic># 获取所有的窗口或选项卡句柄</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>window_handles
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 获取当前窗口或选项卡的句柄</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>current_window_handle
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 切换窗口或选项卡</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>switch_to<span style=color:#000;font-weight:700>.</span>window(handle)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 新建窗口</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>switch_to<span style=color:#000;font-weight:700>.</span>new_window(<span style=color:#d14>&#39;window&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 新建选项卡</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>switch_to<span style=color:#000;font-weight:700>.</span>new_window(<span style=color:#d14>&#39;tab&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># 关闭当前窗口或选项卡</span>
</span></span><span style=display:flex><span>driver<span style=color:#000;font-weight:700>.</span>close()
</span></span></code></pre></div><p>综上，本文使用 Python 示例代码介绍了如何使用 Selenium WebDriver 对页面加载策略、等待策略、元素定位与操作、浏览器操作这些高级特性进行使用。</p><blockquote><p>参考资料</p><p>[1] <a href=https://www.selenium.dev/documentation/webdriver/>WebDriver | Selenium - www.selenium.dev</a></p><p>[2] <a href=https://javascript.info/onload-ondomcontentloaded>Page: DOMContentLoaded, load, beforeunload, unload | The Modern JavaScript Tutorial - javascript.info</a></p><p>[3] <a href=https://ithelp.ithome.com.tw/articles/10197335>重新認識 JavaScript 番外篇之網頁的生命週期 | iT 邦幫忙 - ithelp.ithome.com.tw</a></p><p>[4] <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState>Document: readyState property | MDN - developer.mozilla.org</a></p></blockquote></div><div class=content-footer><div class=weixinhao><img src=/static/images/self/weixinhao-white.jpg></div><div class=post-tags><a href=/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/>#自动化测试</a>
<a href=/tags/selenium/>#Selenium</a>
<a href=/tags/python/>#Python</a></div><div class=license><i class=ti-info-alt></i><div class=info>版权声明：该博客文章由作者通过「<a href=https://creativecommons.org/licenses/by/4.0/deed.zh>知识共享署名 4.0 许可证</a>」进行授权，转载须注明文章原始链接。</div></div></div></div><div class="col-lg-8 mx-auto block shadow"><h3>相关文章</h3><ul><li><a href=/posts/selenium-best-practices.html>Selenium 自动化测试最佳实践</a></li><li><a href=/posts/selenium-webdriver.html>Selenium WebDriver 基础使用</a></li><li><a href=/posts/selenium-grid.html>Selenium Grid 搭建及使用</a></li><li><a href=/posts/how-to-write-ui-test-cases-using-screenplay-pattern.html>如何使用 Screenplay 模式编写 UI 测试用例？</a></li><li><a href=/posts/how-to-perform-ui-testing-using-serenity-bdd.html>如何使用 Serenity BDD 进行 UI 测试？</a></li></ul></div><div class="col-lg-8 mx-auto block shadow"><div><h3>评论</h3><div id=comment-loading style=text-align:center;font-size:14px><img style=width:52px src=/static/images/site/mona-loading-default.gif>
<span>正在加载评论......</span></div><script>function handleMessage(e){if(e.origin!=="https://giscus.app")return;if(typeof e.data!="object"||!e.data.giscus)return;const t=document.getElementById("comment-loading");t.style.display="none"}window.addEventListener("message",handleMessage)</script><script src=https://giscus.app/client.js data-repo=leileiluoluo/leileiluoluo.github.io data-repo-id=R_kgDOJkLT8w data-category=General data-category-id=DIC_kwDOJkLT884CdtEh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></div></div></div></section><footer class="py-4 bg-lights border-top"><div class=container><div class="row justify-content-between text-center align-items-center"><div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0"></div><div class="col-lg-4 text-center mb-4 mb-lg-0"><ul class="list-inline mb-0"><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/sponsor>随喜打赏</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/about>关于本博</a></li><li class=list-inline-item><a class="text-dark d-block p-2" href=https://leileiluoluo.github.io/links>友情链接</a></li></ul></div><div class="col-lg-4 text-lg-right text-center mb-4 mb-lg-0"><ul class="list-inline social-icon mb-0"><li class=list-inline-item><a title=文章归档 href=/archives/><i class=ti-archive></i></a></li><li class=list-inline-item><a title=文章标签 href=/tags/><i class=ti-tag></i></a></li><li class=list-inline-item><a title="我的 GitHub" href=https://github.com/leileiluoluo><i class=ti-github></i></a></li><li class=list-inline-item><a title="网站 RSS" href=/index.xml><i class=ti-rss></i></a></li></ul></div></div><div style=text-align:center;font-size:18px;margin-bottom:22px><a style="-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-image:linear-gradient(to right,#14100f,#d55b5b,#4d14e6)" href=https://www.boyouquan.com/planet-shuttle>「博友圈 · 星球穿梭」</a></div><div class="text-center mt-4"><span>Made with <a href=https://gohugo.io/>Hugo</a> | Theme by <a href=https://github.com/themefisher/northendlab-hugo>NorthendLab</a> | <a href=https://beian.miit.gov.cn>辽ICP备2022012085号-5</a> | Copyright © 2017-2025</span></div></div></footer><script>var indexURL="https://leileiluoluo.github.io/index.json"</script><script src=https://leileiluoluo.github.io/js/jquery.min.js></script><script src=https://leileiluoluo.github.io/js/bootstrap.min.js></script><script src=https://leileiluoluo.github.io/js/fuse.min.js></script><script src=https://leileiluoluo.github.io/js/mark.js></script><script src=https://leileiluoluo.github.io/js/search.js></script><script src=https://leileiluoluo.github.io/js/script.min.js></script></body></html>